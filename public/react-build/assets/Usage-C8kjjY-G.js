import{a as N,b as v,r as n,j as a}from"./index-B_YWOrie.js";import{api as r}from"./api-CYk9FEKy.js";import{L as f}from"./Loading-BvPCrw-b.js";import"./index-LMWlVbK9.js";/* empty css                */const k=({shop:h})=>{const[m]=N(),x=v(),e=h||m.get("shop"),[t,o]=n.useState(null),[l,c]=n.useState(!0),[u,i]=n.useState(!1);n.useEffect(()=>{e&&(d(),j())},[e]);const j=async()=>{if(e)try{const s=await r.getShopBalance(e);s.success&&s.data&&i(s.data.isTestShop===!0)}catch(s){console.error("Error checking shop:",s),i(!1)}},d=async()=>{if(e)try{c(!0);const s=await r.getUsageData(e);s.success&&s.data?o(s.data):o({totalSeconds:0,totalAmount:0,dailyData:[]})}catch(s){console.error("Error loading usage data:",s),o({totalSeconds:0,totalAmount:0,dailyData:[]})}finally{c(!1)}},g=async()=>{if(e)try{await r.exportUsageData(e)}catch(s){console.error("Error exporting usage data:",s),alert("Failed to export usage data: "+s.message)}};return e?a.jsxs("div",{className:"usage-page",children:[u&&a.jsx("div",{className:"blur-overlay",children:a.jsxs("div",{className:"overlay-content",children:[a.jsx("h2",{children:"Connect Your Shopify Store"}),a.jsx("p",{children:"Connect your store to view usage and billing information."}),a.jsx("button",{className:"connect-btn",onClick:()=>x("/integrations"),children:"Connect to Shopify"})]})}),a.jsx("div",{className:"usage-header",children:a.jsxs("div",{style:{display:"flex",gap:12},children:[a.jsxs("button",{className:"refresh-btn",onClick:d,disabled:l,children:[a.jsx("span",{children:"ðŸ”„"}),"Refresh Data"]}),a.jsxs("button",{className:"refresh-btn",onClick:g,style:{background:"#ff6b35"},children:[a.jsx("span",{children:"ðŸ“Š"}),"Export Usage Data"]})]})}),a.jsxs("div",{className:"total-summary",children:[a.jsx("h2",{children:"Total Usage & Billing"}),a.jsxs("div",{className:"total-stats",children:[a.jsxs("div",{className:"total-stat",children:[a.jsx("div",{className:"total-stat-value",children:l?"-":(t?.totalSeconds||0).toLocaleString()}),a.jsx("div",{className:"total-stat-label",children:"Total Seconds Used"})]}),a.jsxs("div",{className:"total-stat",children:[a.jsx("div",{className:"total-stat-value",children:l?"â‚¹-":`â‚¹${(t?.totalAmount||0).toFixed(2)}`}),a.jsx("div",{className:"total-stat-label",children:"Total Amount Billed"})]})]})]}),a.jsxs("div",{className:"daily-breakdown",children:[a.jsx("h3",{className:"section-title",children:"Daily Breakdown"}),a.jsx("div",{className:"daily-content",children:l?a.jsx("div",{className:"loading",children:a.jsx(f,{size:"medium",text:"Loading daily usage data..."})}):!t||!t.dailyData||t.dailyData.length===0?a.jsxs("div",{className:"empty-state",children:[a.jsx("div",{className:"empty-state-icon",children:"ðŸ“Š"}),a.jsx("div",{children:"No usage data available"})]}):a.jsxs("table",{className:"daily-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Date"}),a.jsx("th",{children:"Seconds Used"}),a.jsx("th",{children:"Amount (â‚¹)"})]})}),a.jsx("tbody",{children:t.dailyData.map((s,p)=>a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx("a",{href:`/call-history?shop=${encodeURIComponent(e)}&date=${s.date}`,className:"date-link",children:s.date})}),a.jsx("td",{className:"seconds-cell",children:s.seconds||0}),a.jsxs("td",{className:"amount-cell",children:["â‚¹",(s.amount||0).toFixed(2)]})]},p))})]})})]})]}):a.jsx("div",{className:"usage-page",children:a.jsx("div",{className:"error-message",children:"No shop parameter found. Please select a shop."})})};export{k as default};
