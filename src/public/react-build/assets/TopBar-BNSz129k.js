import{r as t,b as D,a as W,j as e,R as F}from"./index-B_YWOrie.js";import{api as V}from"./api-CYk9FEKy.js";const z=({shop:v})=>{const[o,d]=t.useState(!1),[u,E]=t.useState({}),[I,b]=t.useState(!1),[R,w]=t.useState(!1),g=t.useRef(null),U=D(),[m]=W(),h=v||m.get("shop");t.useEffect(()=>{const s=()=>{try{const c=localStorage.getItem("onboarding-completed-steps");c&&E(JSON.parse(c))}catch(c){console.error("Error loading completed steps:",c)}};s();const r=()=>{s()};return window.addEventListener("storage",r),window.addEventListener("onboardingStepsChanged",r),()=>{window.removeEventListener("storage",r),window.removeEventListener("onboardingStepsChanged",r)}},[]),t.useEffect(()=>{(async()=>{if(h)try{const c=await(await fetch("/api/integrations/status",{credentials:"include"})).json();b(c.connected||!1);const x=await(await fetch(`/api/google-sheets-settings?shop=${encodeURIComponent(h)}`,{credentials:"include"})).json();x.success&&x.settings&&w(x.settings.googleSheetsEnabled||!1)}catch(r){console.error("Error checking integration status:",r)}})()},[h]);const S=t.useRef(null);t.useEffect(()=>{const s=r=>{g.current&&!g.current.contains(r.target)&&S.current&&!S.current.contains(r.target)&&d(!1)};if(o)return document.addEventListener("mousedown",s),()=>document.removeEventListener("mousedown",s)},[o]);const T=s=>{if(!h)return s;const r=s.includes("?")?"&":"?";return`${s}${r}shop=${encodeURIComponent(h)}`},j=I||R,C=u.step1||j,_=u.step2||!1,f=u.step3||!1,p=u.step4||!1,N=u.step5||!1,y=[C,_,f,p,N].filter(Boolean).length,a=C&&_&&f&&p&&N,k=5-y,P=[{number:1,title:"Connect Your Data Source",complete:C},{number:2,title:"Create Your First Script",complete:_},{number:3,title:"Test Your Script",complete:f},{number:4,title:"Set Up Call Settings",complete:p},{number:5,title:"Start Making Calls",complete:N}],L=s=>{d(!1),U(T("/onboarding"))};return a?null:e.jsxs("div",{className:"onboarding-notification-wrapper",children:[e.jsxs("button",{ref:S,className:"onboarding-notification-button",onClick:s=>{s.stopPropagation(),d(!o)},children:[e.jsx("img",{src:"/images/Raycons Icons Pack (Community)/book-8535533.svg",alt:"Onboarding",width:"20",height:"20"}),k>0&&e.jsx("span",{className:"onboarding-notification-badge",children:k})]}),o&&e.jsxs("div",{className:"onboarding-popup",ref:g,children:[e.jsxs("div",{className:"onboarding-popup-header",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"onboarding-popup-title",children:"Get Started"}),e.jsxs("p",{className:"onboarding-popup-progress",children:[y," of 5 complete!"]})]}),e.jsx("button",{className:"onboarding-popup-close",onClick:()=>d(!1),children:e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),e.jsx("div",{className:"onboarding-popup-progress-bar",children:e.jsx("div",{className:"onboarding-popup-progress-fill",style:{width:`${y/5*100}%`}})}),e.jsx("div",{className:"onboarding-popup-steps",children:P.map((s,r)=>e.jsxs(F.Fragment,{children:[e.jsxs("div",{className:`onboarding-popup-step ${s.complete?"complete":""}`,onClick:()=>L(s.number),children:[e.jsx("div",{className:"onboarding-popup-step-icon",children:s.complete?e.jsx("div",{className:"step-icon-complete",children:e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"3",children:e.jsx("polyline",{points:"20 6 9 17 4 12"})})}):e.jsx("div",{className:"step-icon-pending"})}),e.jsx("span",{className:"onboarding-popup-step-title",children:s.title}),e.jsx("img",{src:"/images/Raycons Icons Pack (Community)/arrow-right-8532512.svg",alt:"",width:"16",height:"16",className:"onboarding-popup-step-arrow"})]}),r<P.length-1&&e.jsx("div",{className:"onboarding-popup-divider"})]},s.number))})]})]})},G=({pageTitle:v,shop:o})=>{const[d,u]=t.useState(""),[E,I]=t.useState(""),[b,R]=t.useState(""),[w,g]=t.useState(""),[U,m]=t.useState(!1),[h,S]=t.useState("13 mins left"),[T,j]=t.useState(!1),[C,_]=t.useState(!1),[f,p]=t.useState(!1),[N,y]=t.useState(!1),[a,k]=t.useState("base"),[P,L]=t.useState(!1),[s,r]=t.useState(0),c=t.useRef(null),M=D(),x={Dashboard:{title:"Dashboard",description:"View analytics and key performance indicators.",buttonText:"Learn More"},"CSV Upload":{title:"CSV Upload",description:"Upload customer data to create call campaigns.",buttonText:"Learn More"},Agents:{title:"Create Scripts & Agents",description:"Build agents that automate tasks and improve over time.",buttonText:"Watch Tutorial"},Scripts:{title:"Call Scripts",description:"Design and customize scripts for your AI agents.",buttonText:"Learn More"},"Call History":{title:"Call History",description:"Review past call records and performance metrics.",buttonText:"Learn More"},Stats:{title:"Statistics",description:"Analyze insights from your call campaigns.",buttonText:"Learn More"},Usage:{title:"Usage & Billing",description:"Monitor account usage and subscription details.",buttonText:"Learn More"},Pricing:{title:"Pricing Plans",description:"View and manage your subscription plans.",buttonText:"Learn More"},Voices:{title:"AI Voices",description:"Browse and select voices for your agents.",buttonText:"Learn More"},"Clone Voice":{title:"Voice Cloning",description:"Create custom voices by cloning samples.",buttonText:"Learn More"},"Phone Numbers":{title:"Phone Numbers",description:"Manage phone numbers for your account.",buttonText:"Learn More"},Integrations:{title:"Integrations",description:"Connect and manage external service integrations.",buttonText:"Learn More"},Settings:{title:"Settings",description:"Configure account settings and preferences.",buttonText:"Learn More"}};t.useEffect(()=>{const n=async()=>{if(!o){m(!1);return}try{const B=await(await fetch(`/api/orders/in-progress?shop=${encodeURIComponent(o)}`,{credentials:"include"})).json();B.success?m(B.hasInProgress||!1):m(!1)}catch(l){console.error("Error checking ongoing calls:",l),m(!1)}};n();const i=setInterval(n,5e3);return()=>clearInterval(i)},[o]),t.useEffect(()=>{(async()=>{try{const i=await V.getUserProfile();if(i.success&&i.data&&(u(i.data.email||""),I(i.data.name||""),R(i.data.avatar||""),o?g(o):i.data.shop&&g(i.data.shop)),o)try{const l=await V.getShopBalance(o);l.success&&l.data&&(l.data.plan&&k(l.data.plan),l.data.channels!==void 0&&r(l.data.channels))}catch(l){console.error("Error loading shop plan:",l)}}catch(i){console.error("Error loading user data:",i)}})()},[o]),t.useEffect(()=>{const n=i=>{c.current&&!c.current.contains(i.target)&&p(!1)};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[]);const $=()=>{window.location.href="/auth/logout"},A=()=>{const n=o?`?shop=${encodeURIComponent(o)}`:"";M(`/integrations${n}`),p(!1)},O=()=>{const n=o?`?shop=${encodeURIComponent(o)}`:"";M(`/settings${n}`),p(!1)};return e.jsx("header",{className:"topbar",children:e.jsxs("div",{className:"topbar__inner",children:[e.jsxs("div",{className:"topbar__left",children:[e.jsx("h1",{className:"topbar__page-title",children:v||"Dashboard"}),e.jsxs("div",{className:"topbar__info-icon",onMouseEnter:()=>j(!0),onMouseLeave:()=>j(!1),children:[e.jsx("img",{src:"/images/Info.svg",alt:"Info",width:"20",height:"20"}),T&&e.jsx("div",{className:"topbar__tooltip topbar__tooltip--info",children:(()=>{const n=x[v]||{title:"Information",description:"Information about this page",buttonText:"Learn More"};return e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"topbar__tooltip-title",children:n.title}),e.jsx("p",{className:"topbar__tooltip-description",children:n.description}),e.jsx("button",{className:"topbar__tooltip-button",children:n.buttonText})]})})()})]})]}),e.jsxs("div",{className:"topbar__right",children:[o&&e.jsxs("div",{className:"topbar__channels",style:{display:"inline-flex",alignItems:"center",gap:"1px",padding:"8px 16px",borderRadius:"6px",fontSize:"20px",fontWeight:500,color:"#374151"},children:[e.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{flexShrink:0},children:[e.jsx("rect",{id:"Rectangle_5","data-name":"Rectangle 5",width:"24",height:"24",fill:"none"}),e.jsx("path",{id:"Shape",d:"M7.02,15.976,5.746,13.381a.7.7,0,0,0-.579-.407l-1.032-.056a.662.662,0,0,1-.579-.437,9.327,9.327,0,0,1,0-6.5.662.662,0,0,1,.579-.437l1.032-.109a.7.7,0,0,0,.589-.394L7.03,2.446l.331-.662a.708.708,0,0,0,.07-.308.692.692,0,0,0-.179-.467A3,3,0,0,0,4.693.017l-.235.03L4.336.063A1.556,1.556,0,0,0,4.17.089l-.162.04C1.857.679.165,4.207,0,8.585V9.83c.165,4.372,1.857,7.9,4,8.483l.162.04a1.556,1.556,0,0,0,.165.026l.122.017.235.03a3,3,0,0,0,2.558-.993.692.692,0,0,0,.179-.467.708.708,0,0,0-.07-.308Z",transform:"translate(4.393 6.587) rotate(-30)",fill:"none",stroke:"#000000",strokeMiterlimit:"10",strokeWidth:"1.5"})]}),e.jsx("span",{children:"×"}),e.jsx("span",{children:s>0?Math.max(1,Math.floor(s/2)):0})]}),o&&e.jsxs("div",{className:"topbar__plan-badge",onMouseEnter:()=>L(!0),onMouseLeave:()=>L(!1),style:{position:"relative",display:"inline-flex",alignItems:"center",padding:"6px 12px",borderRadius:"6px",fontSize:"12px",fontWeight:600,backgroundColor:a==="pro"?"#F59E0B":a==="pro-plus"||a==="proplus"?"#8B5CF6":a==="enterprise"?"#6366F1":"#10B981",color:"white",cursor:"pointer",textTransform:"none"},children:[a==="base"?"Base Plan (₹2,800/mo)":a==="pro"?"Pro Plan (₹4,900/mo)":a==="pro-plus"||a==="proplus"?"Pro Plus Plan (10 Channels)":a==="enterprise"?"Enterprise Plan (Custom)":"Base Plan (₹2,800/mo)",P&&e.jsx("div",{style:{position:"absolute",bottom:"100%",right:0,marginBottom:"8px",padding:"8px 12px",backgroundColor:"#1F2937",color:"white",borderRadius:"6px",fontSize:"12px",whiteSpace:"nowrap",zIndex:1e3,boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:a==="base"?"Base Plan":a==="pro"?"Pro Plan":a==="pro-plus"||a==="proplus"?"Pro Plus Plan":a==="enterprise"?"Enterprise Plan":"Base Plan"})]}),e.jsx(z,{shop:o}),e.jsx("img",{src:b||"/images/1 Happy.svg",alt:"User avatar",className:`topbar__user-avatar-standalone ${b&&!b.startsWith("/images/")?"topbar__user-avatar-standalone--profile":"topbar__user-avatar-standalone--memoji"}`,onError:n=>{n.target.src="/images/1 Happy.svg",n.target.className="topbar__user-avatar-standalone topbar__user-avatar-standalone--memoji"}}),e.jsxs("div",{className:"topbar__user-dropdown",ref:c,children:[e.jsxs("button",{className:"topbar__user-btn",onClick:()=>p(!f),"aria-label":"User menu",children:[e.jsx("span",{className:"topbar__user-name",children:E||d||"User"}),e.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M6 9L12 15L18 9",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})]}),f&&e.jsxs("div",{className:"topbar__dropdown-menu",children:[e.jsx("div",{className:"topbar__dropdown-item topbar__dropdown-item--email",children:d||"No email"}),w&&e.jsx("button",{className:"topbar__dropdown-item topbar__dropdown-item--clickable",onClick:A,children:w}),e.jsx("button",{className:"topbar__dropdown-item topbar__dropdown-item--clickable",onClick:O,children:"Settings"})]})]}),e.jsx("button",{className:"topbar__icon-btn",onClick:$,"aria-label":"Logout",children:e.jsx("img",{src:"/images/logout.svg",alt:"Logout",width:"20",height:"20"})})]})]})})};export{G as default};
