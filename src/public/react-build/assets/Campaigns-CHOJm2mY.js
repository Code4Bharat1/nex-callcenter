import{c as je,a as ba,b as va,r as l,j as e,R as Na}from"./index-B_YWOrie.js";import{api as wa}from"./api-CYk9FEKy.js";import{L as ps}from"./Loading-BvPCrw-b.js";import{p as Sa}from"./transcriptParser-B0Eamk1c.js";import{R as ka}from"./RetryStatusBars-rJSPy1dC.js";/* empty css                  */import{S as Aa,R as fe}from"./search-B91U6_p5.js";import{T as ye}from"./table-2-Bxe71p5G.js";import{D as Ua}from"./download-CI06Yj7G.js";import"./index-LMWlVbK9.js";/* empty css                */const Da=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Ea=je("info",Da);const Ia=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],Oa=je("pencil",Ia);const Ra=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],$a=je("trash-2",Ra),it=({shop:ms})=>{const[us]=ba(),N=va(),o=ms||us.get("shop"),[Ba,Ce]=l.useState(null),[Ta,be]=l.useState(!1),[b,F]=l.useState([]),[E,ve]=l.useState(null),[za,Y]=l.useState(null),[Fa,Ne]=l.useState(null),[we,hs]=l.useState([]),[K,Pa]=l.useState(null),[Se,ke]=l.useState(!1),[I,gs]=l.useState(1),[k,xs]=l.useState(null),[fs,ys]=l.useState({}),[Ae,js]=l.useState({}),[Ue,De]=l.useState({}),[Cs,Ee]=l.useState({}),[bs,Ie]=l.useState({}),[O,vs]=l.useState([]),[Ns,R]=l.useState(!1),[Z,Oe]=l.useState([]),[ws,Re]=l.useState(!1),[Ss,A]=l.useState(!1),[p,ks]=l.useState(null),[y,As]=l.useState([]),[Us,$e]=l.useState(!1),[$,P]=l.useState(new Set),[Be,X]=l.useState(!1),[w,L]=l.useState([]),[Te,Ds]=l.useState(""),[G,Es]=l.useState("all"),[ee,Is]=l.useState(""),[La,Ma]=l.useState({}),[se,ae]=l.useState([]),[te,B]=l.useState([]),[Os,ze]=l.useState(!1),[Fe,Pe]=l.useState(!1),[Le,Me]=l.useState(null),[f,Rs]=l.useState("all"),[$s,M]=l.useState(!1),[m,Bs]=l.useState(null),[Ts,V]=l.useState(!1),[ne,W]=l.useState(null),[ie,H]=l.useState(null),[T,Ve]=l.useState(!1),[Va,zs]=l.useState(null),[Wa,We]=l.useState(!1),[Fs,He]=l.useState([]),[Ps,qe]=l.useState(!1),[Qe,le]=l.useState([]),[Ls,_e]=l.useState(!1),[Je,oe]=l.useState([]),[Ms,Ye]=l.useState(!1),[v,re]=l.useState(null),[Ha,Ke]=l.useState(!1),[ce,qa]=l.useState({data:[],labels:[]}),[Vs,Qa]=l.useState(!1),[Ws,_a]=l.useState(null),[U,S]=l.useState(!1);l.useEffect(()=>{o&&(Qs(),j(1),q(),Hs(),qs(),Js())},[o]),l.useEffect(()=>{o&&f==="clips"&&q()},[o,f]),l.useEffect(()=>{o&&f==="test-calls"&&(Ze(),Xe())},[o,f]),l.useEffect(()=>{const a=s=>{U&&!s.target.closest(".create-button-wrapper")&&S(!1)};if(U)return document.addEventListener("mousedown",a),()=>{document.removeEventListener("mousedown",a)}},[U]);const Hs=async()=>{if(o){We(!0);try{const s=await(await fetch(`/api/non-campaign-orders?shop=${encodeURIComponent(o)}&page=1&limit=1`,{credentials:"include"})).json();s.success&&s.pagination&&zs(s.pagination.totalCount||0)}catch(a){console.error("[Campaigns] Error loading non-campaign orders count:",a)}finally{We(!1)}}},qs=async()=>{if(o){qe(!0);try{const s=await(await fetch(`/api/non-campaign-orders-by-day?shop=${encodeURIComponent(o)}`,{credentials:"include"})).json();s.success&&s.dayGroups&&He(s.dayGroups||[])}catch(a){console.error("[Campaigns] Error loading non-campaign orders by day:",a),He([])}finally{qe(!1)}}},Qs=async()=>{try{const a=await wa.getScripts(o),s=a?.scripts||a||[];vs(s)}catch(a){console.error("[Campaigns] Error loading scripts:",a)}},q=async()=>{if(o){ze(!0);try{const s=await(await fetch(`/api/clips/all?shop=${encodeURIComponent(o)}`,{credentials:"include"})).json();s.success?ae(s.clips||[]):(console.error("[Campaigns] Failed to load clips:",s.error),ae([]))}catch(a){console.error("[Campaigns] Error loading clips:",a),ae([])}finally{ze(!1)}}},_s=async()=>{if(o)try{const s=await(await fetch(`/api/clips/all?shop=${encodeURIComponent(o)}`,{credentials:"include"})).json();s.success?B(s.clips||[]):(console.error("[Campaigns] Failed to load all clips:",s.error),B([]))}catch(a){console.error("[Campaigns] Error loading all clips:",a),B([])}},Js=async()=>{if(o){Ke(!0);try{const s=await(await fetch(`/api/auto-call-settings?shop=${encodeURIComponent(o)}`,{credentials:"include"})).json();s.success?re(s.settings):(console.error("[Campaigns] Failed to load auto call settings:",s.error),re(null))}catch(a){console.error("[Campaigns] Error loading auto call settings:",a),re(null)}finally{Ke(!1)}}},Ze=async()=>{if(o){_e(!0);try{const s=await(await fetch(`/api/test-calls-by-day?shop=${encodeURIComponent(o)}`,{credentials:"include"})).json();s.success?le(s.dayGroups||[]):(console.error("[Campaigns] Failed to load test calls:",s.error),le([]))}catch(a){console.error("[Campaigns] Error loading test calls:",a),le([])}finally{_e(!1)}}},Xe=async()=>{if(o){Ye(!0);try{const s=await(await fetch(`/api/test-csv-uploads?shop=${encodeURIComponent(o)}`,{credentials:"include"})).json();s.success?(oe(s.csvUploads||[]),console.log("[Campaigns] Loaded test CSV uploads:",s.csvUploads?.length||0)):(console.error("[Campaigns] Failed to load test CSV uploads:",s.error),oe([]))}catch(a){console.error("[Campaigns] Error loading test CSV uploads:",a),oe([])}finally{Ye(!1)}}},Ge=async a=>{if(!o){console.error("[Campaigns] No shop found, cannot load clip orders");return}console.log("[Campaigns] Loading clip orders, creating CSV upload:",{clipId:a,shop:o});try{const s=se.find(i=>i.id===a)||te.find(i=>i.id===a);s&&Me(s.name);const t=await fetch(`/api/clips/${a}/create-csv-upload`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({shop:o})});if(console.log("[Campaigns] Response status:",t.status),!t.ok){const i=await t.text();throw console.error("[Campaigns] Response error:",i),new Error(`HTTP ${t.status}: ${i}`)}const n=await t.json();if(console.log("[Campaigns] Response data:",n),n.success){console.log("[Campaigns] Clip converted to CSV upload:",n.csvUploadId),console.log("[Campaigns] Orders received:",n.orders?.length||0);const i=n.csvUploadId,r=n.orders||[];ve(i),F(r),L([]),Y(null),Ne(null),r.length>0&&(ts(i,r),Gs(i)),setTimeout(()=>{console.log("[Campaigns] Reloading CSV history to show new upload"),j(1)},500),setTimeout(()=>{const c=document.querySelector(".current-upload-section");c&&c.scrollIntoView({behavior:"smooth",block:"start"})},100)}else alert("âŒ Failed to create CSV upload from clip: "+(n.error||"Unknown error"))}catch(s){console.error("[Campaigns] Error loading clip orders:",s),alert("âŒ Error loading clip orders: "+s.message)}},es=async(a,s)=>{if(s.stopPropagation(),!!confirm("Are you sure you want to delete this clip? This action cannot be undone.")&&o)try{const n=await(await fetch(`/api/clips/${a}?shop=${encodeURIComponent(o)}`,{method:"DELETE",credentials:"include"})).json();n.success?(alert("âœ… Clip deleted successfully"),q(),Fe&&_s()):alert("âŒ Error deleting clip: "+(n.error||"Unknown error"))}catch(t){console.error("[Campaigns] Error deleting clip:",t),alert("âŒ Error deleting clip: "+t.message)}},j=async(a=1)=>{if(o){ke(!0);try{console.log("[Campaigns] Loading CSV history for shop:",o,"page:",a);const t=await(await fetch(`/api/csv-history?shop=${encodeURIComponent(o)}&page=${a}&limit=10&isRtoAnalysis=false`,{credentials:"include"})).json();if(console.log("[Campaigns] CSV history response:",t),t.success){const n=t.data.uploads||[];console.log("[Campaigns] Setting CSV history with",n.length,"uploads"),console.log("[Campaigns] Upload IDs:",n.map(i=>i.id)),hs(n),xs(t.data.pagination),gs(a)}else console.error("[Campaigns] Failed to load CSV history:",t.error)}catch(s){console.error("[Campaigns] Error loading CSV history:",s)}finally{ke(!1)}}},Ys=async a=>{const s=a.target.files[0];s&&(Ce(s),await Zs(s))},Ks=async()=>{if(!ne){alert("Please select a CSV file");return}if(!o){alert("Please select a store first");return}Ve(!0);const a=new FormData;a.append("csvFile",ne),a.append("shop",o),ie&&a.append("scriptId",ie);try{const t=await(await fetch(`/api/upload-orders?shop=${encodeURIComponent(o)}`,{method:"POST",body:a,credentials:"include"})).json();t.success?(alert(`âœ… Successfully uploaded ${t.created} orders${t.errors.length>0?`
âš ï¸ ${t.errors.length} errors occurred`:""}`),V(!1),W(null),H(null),o&&(await j(1),t.csvUploadId&&console.log(`âœ… Created CSV upload campaign: ${t.csvUploadId}`))):alert(`âŒ Failed to upload orders: ${t.error||"Unknown error"}
${t.errors?.length>0?`Errors: ${t.errors.map(n=>`Row ${n.row}: ${n.error}`).join(`
`)}`:""}`)}catch(s){console.error("[Campaigns] Error uploading orders:",s),alert("âŒ Error uploading orders: "+s.message)}finally{Ve(!1)}},ss=()=>{const a=`customerPhone,customerName,customerAddress,totalPrice,currency,orderNumber
9876543210,John Doe,123 Main St,1000,INR,
9876543211,Jane Smith,456 Oak Ave,2000,INR,`,s=new Blob([a],{type:"text/csv"}),t=window.URL.createObjectURL(s),n=document.createElement("a");n.href=t,n.download="sample_orders.csv",document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(t)},Zs=async a=>{if(!a){alert("Please select a file first");return}if(!o){alert("Please select a store first");return}be(!0);const s=new FormData;s.append("csvFile",a),s.append("shop",o);try{const n=await(await fetch(`/api/upload-csv?shop=${encodeURIComponent(o)}`,{method:"POST",body:s,credentials:"include"})).json();if(n.success){console.log("[Campaigns] CSV upload successful:",n),console.log("[Campaigns] CSV upload ID:",n.csvUploadId),console.log("[Campaigns] Orders received:",n.orders?.length||0),Ce(null);const i=document.getElementById("campaigns-csv-file-header");i&&(i.value="");const r=n.csvUploadId,c=n.orders||[];console.log("[Campaigns] Setting current upload orders:",c.length),F(c),ve(r),Y(n.stats||null),Ne(n.script||null),Me(null),await j(1),alert("CSV uploaded successfully!")}else alert(n.error||"Failed to upload CSV")}catch(t){console.error("[Campaigns] Error uploading CSV:",t),alert("Error uploading CSV. Please try again.")}finally{be(!1)}},as=async a=>{Ee(s=>({...s,[a]:!0}));try{const t=await(await fetch(`/api/csv-results?csvUploadId=${a}&shop=${encodeURIComponent(o)}`,{credentials:"include"})).json();t.success&&(ys(n=>({...n,[a]:t.orders||[]})),ts(a,t.orders),Xs(a))}catch(s){console.error(`[Campaigns] Error loading orders for ${a}:`,s)}finally{Ee(s=>({...s,[a]:!1}))}},ts=(a,s)=>{const t={};s.forEach(i=>{if(i.script&&i.script.id){const r=i.script.id;t[r]=(t[r]||0)+1}});const n=Object.entries(t).sort((i,r)=>r[1]-i[1])[0]?.[0];if(n){const i=O.find(r=>r.id===parseInt(n))||s.find(r=>r.script&&r.script.id===parseInt(n))?.script;i&&De(r=>({...r,[a]:i}))}else{const i=O.find(r=>{const c=r.name.toLowerCase();return c.includes("house")&&c.includes("direction")||c.includes("house dir")||c.includes("address")&&c.includes("extraction")});i&&De(r=>({...r,[a]:i}))}},Xs=async a=>{Ie(s=>({...s,[a]:!0}));try{const t=await(await fetch(`/api/csv-stats?csvUploadId=${a}&shop=${encodeURIComponent(o)}`,{credentials:"include"})).json();t.success&&js(n=>({...n,[a]:t.stats}))}catch(s){console.error(`[Campaigns] Error loading stats for ${a}:`,s)}finally{Ie(s=>({...s,[a]:!1}))}},Gs=async a=>{try{const t=await(await fetch(`/api/csv-stats?csvUploadId=${a}&shop=${encodeURIComponent(o)}`,{credentials:"include"})).json();t.success&&Y(t.stats)}catch(s){console.error("[Campaigns] Error loading stats for current upload:",s)}},ns=a=>{Oe(a),R(!0)},ea=async(a,s)=>{R(!1),Re(!0);try{const n=await(await fetch("/api/set-queue-bulk",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orderIds:Z,shop:o,scriptId:a}),credentials:"include"})).json();if(n.success){const i=n.updated||0,r=n.failed?.length||0;alert(`âœ… Bulk AI Call completed!

ðŸ“Š Results:
â€¢ Successfully queued: ${i}
â€¢ Failed: ${r}`)}else alert(`âŒ Bulk AI Call failed: ${n.error||"Unknown error"}`);if(K&&as(K),E){const r=await(await fetch(`/api/csv-results?csvUploadId=${E}&shop=${encodeURIComponent(o)}`,{credentials:"include"})).json();r.success&&F(r.orders||[])}Oe([])}catch(t){console.error("Error in bulk call:",t),alert("Error processing bulk call")}finally{Re(!1)}},Q=async a=>{$e(!0),A(!0);try{const t=await(await fetch(`/api/order-details?orderId=${a}&shop=${encodeURIComponent(o)}`,{credentials:"include"})).json();t.success?(ks(t.order),As(t.calls||[])):(alert("Failed to load order details"),A(!1))}catch(s){console.error("[Campaigns] Error loading order details:",s),alert("Error loading order details"),A(!1)}finally{$e(!1)}},sa=a=>{if(!a)return"N/A";try{return new Date(a).toLocaleString("en-IN",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0,timeZone:"Asia/Kolkata"})}catch{return"N/A"}},aa=async(a,s)=>{if(confirm("Are you sure you want to update the address in Shopify? This will change the actual order address."))try{console.log("[Campaigns] Updating address in Shopify:",{orderId:a,shop:o,newAddress:s});const n=await(await fetch("/api/update-order-address",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orderId:a,shop:o,newAddress:s})})).json();n.success?(alert("âœ… Address updated successfully in Shopify!"),p&&Q(p.orderId||p.id)):alert("âŒ Failed to update address: "+(n.error||"Unknown error"))}catch(t){console.error("[Campaigns] Error updating address:",t),alert("âŒ Error updating address: "+t.message)}},ta=(a,s,t)=>{const n=document.createElement("div");n.className="modal-overlay",n.style.cssText=`
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 10000;
      font-family: Inter, system-ui, -apple-system, sans-serif;
    `;const i=document.createElement("div");i.style.cssText=`
      background: white;
      border-radius: 12px;
      padding: 24px;
      max-width: 600px;
      width: 90%;
      max-height: 80vh;
      overflow-y: auto;
      box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
    `,i.innerHTML=`
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
        <h3 style="margin: 0; color: #202223; font-size: 18px; font-weight: 600;">Address Comparison</h3>
        <button onclick="this.closest('.modal-overlay').remove()" style="background: none; border: none; font-size: 24px; cursor: pointer; color: #6d7175; padding: 0; width: 24px; height: 24px;">&times;</button>
      </div>
      
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
        <div style="border: 1px solid #e1e3e5; border-radius: 8px; padding: 16px; background: #f8f9fa;">
          <div style="display: flex; align-items: center; margin-bottom: 12px;">
            <div style="width: 8px; height: 8px; background: #ef4444; border-radius: 50%; margin-right: 8px;"></div>
            <h4 style="margin: 0; color: #ef4444; font-size: 14px; font-weight: 600; text-transform: uppercase;">Current Address</h4>
          </div>
          <div style="color: #202223; font-size: 14px; line-height: 1.5; word-wrap: break-word;">${s||"N/A"}</div>
        </div>
        
        <div style="border: 1px solid #e1e3e5; border-radius: 8px; padding: 16px; background: #f0f8f0;">
          <div style="display: flex; align-items: center; margin-bottom: 12px;">
            <div style="width: 8px; height: 8px; background: #10b981; border-radius: 50%; margin-right: 8px;"></div>
            <h4 style="margin: 0; color: #10b981; font-size: 14px; font-weight: 600; text-transform: uppercase;">New Address</h4>
          </div>
          <textarea id="newAddressEdit" style="width: 100%; min-height: 80px; padding: 8px; border: 1px solid #d1d5db; border-radius: 4px; font-size: 14px; line-height: 1.5; resize: vertical; font-family: inherit;">${t||""}</textarea>
        </div>
      </div>
      
      <div style="display: flex; gap: 12px; justify-content: flex-end;">
        <button onclick="this.closest('.modal-overlay').remove()" style="padding: 8px 16px; border: 1px solid #d1d5db; background: white; color: #374151; border-radius: 6px; font-size: 14px; cursor: pointer;">Close</button>
        <button id="saveNewAddressBtn" style="padding: 8px 16px; border: none; background: #10b981; color: white; border-radius: 6px; font-size: 14px; cursor: pointer; font-weight: 500;">Save Changes</button>
      </div>
    `,n.appendChild(i),document.body.appendChild(n);const r=i.querySelector("#saveNewAddressBtn");r.onclick=async()=>{const u=i.querySelector("#newAddressEdit").value.trim();if(!u){alert("Please enter a new address");return}try{const g=await(await fetch("/api/update-csv-new-address",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({callId:a,newAddress:u})})).json();g.success?(alert("âœ… Address updated successfully!"),n.remove(),p&&Q(p.orderId||p.id)):alert("âŒ Error updating address: "+g.error)}catch(d){console.error("[Campaigns] Error saving new address:",d),alert("âŒ Error saving address: "+d.message)}}},na=async(a,s)=>{const t=prompt("Enter new filename:",s);if(!(!t||t.trim()===""||t===s))try{const i=await(await fetch(`/api/csv/${a}/rename`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({filename:t.trim()})})).json();i.success?(alert("âœ… CSV upload renamed successfully"),j(I)):alert("âŒ Failed to rename CSV: "+(i.error||"Unknown error"))}catch(n){console.error("[Campaigns] Error renaming CSV:",n),alert("âŒ Error renaming CSV upload: "+n.message)}},ia=async a=>{if(confirm("Are you sure you want to delete this CSV upload? The usage data will be preserved."))try{const t=await(await fetch(`/api/csv/${a}/delete`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"}})).json();t.success?(alert("âœ… CSV upload deleted successfully"),j(I)):alert("âŒ Failed to delete CSV: "+(t.error||"Unknown error"))}catch(s){console.error("[Campaigns] Error deleting CSV:",s),alert("âŒ Error deleting CSV upload: "+s.message)}},la=(a,s)=>{try{console.log("[Campaigns] Downloading audio from URL:",a);const t=document.createElement("a");t.href=a,t.download=`call_${s||"audio"}.mp3`,t.target="_blank",document.body.appendChild(t),t.click(),document.body.removeChild(t)}catch(t){console.error("[Campaigns] Error downloading audio:",t),alert("Error downloading audio: "+t.message)}},oa=async a=>{if(confirm("Are you sure you want to update ALL addresses with new addresses in Shopify? This will change the actual order addresses for all orders that have updated addresses."))try{console.log("[Campaigns] Starting bulk address update for upload:",a);const s=document.createElement("div");s.style.cssText=`
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: white;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        z-index: 10000;
      `,s.textContent="Updating addresses in Shopify...",document.body.appendChild(s);const n=await(await fetch("/api/bulk-update-addresses",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({uploadId:a,shop:o})})).json();if(s.remove(),n.success){const{updated:i,failed:r,total:c}=n.results;let u=`âœ… Bulk update completed!

`;if(u+=`ðŸ“Š Results:
`,u+=`â€¢ Total orders processed: ${c}
`,u+=`â€¢ Successfully updated: ${i}
`,u+=`â€¢ Failed: ${r}
`,r>0&&n.results.errors&&console.error("[Campaigns] Bulk update errors:",n.results.errors),alert(u),a===E){const g=await(await fetch(`/api/csv-results?csvUploadId=${a}&shop=${encodeURIComponent(o)}`,{credentials:"include"})).json();g.success&&F(g.orders||[])}else as(a)}else alert("âŒ Bulk update failed: "+(n.error||"Unknown error"))}catch(s){console.error("[Campaigns] Error in bulk address update:",s),alert("âŒ Error in bulk address update: "+s.message)}},is=a=>{if(!a)return"N/A";try{const s=new Date(a),t=s.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),n=s.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});return`${t} at ${n}`}catch{return"N/A"}},ra=a=>{if(!a)return"N/A";try{const s=new Date(a),t=5.5*60*60*1e3;return new Date(s.getTime()+t).toLocaleDateString("en-IN",{year:"numeric",month:"short",day:"numeric"})}catch{return"N/A"}},ca=a=>{if(!a)return{filledBars:2,totalBars:4,label:"Neutral",color:"#fef3c7",barColor:"#f59e0b"};const s=a.toLowerCase();return s.includes("very happy")||s.includes("very_happy")||s==="veryhappy"?{filledBars:4,totalBars:4,label:"Very happy",color:"#d1fae5",barColor:"#10b981"}:s.includes("happy")||s==="positive"?{filledBars:3,totalBars:4,label:"Happy",color:"#dbeafe",barColor:"#3b82f6"}:s.includes("unhappy")||s.includes("negative")||s==="sad"||s==="angry"?{filledBars:1,totalBars:4,label:"Unhappy",color:"#fce7f3",barColor:"#ec4899"}:{filledBars:2,totalBars:4,label:"Neutral",color:"#fef3c7",barColor:"#f59e0b"}},ls=a=>a?a.split("_").map(s=>s.charAt(0).toUpperCase()+s.slice(1)).join(" "):"Pending",z=a=>(a.queuedOrders||0)===0?{isActive:!1,label:"Completed",dotColor:"#ef4444"}:{isActive:!0,label:"Active",dotColor:"#10b981"},os=a=>(a.queuedCalls||0)>0?{isActive:!0,label:"Active",dotColor:"#10b981"}:{isActive:!1,label:"Completed",dotColor:"#ef4444"},da=a=>f==="all"?a:f==="clips"?[]:f==="test-calls"?[]:f==="scheduled"?[]:f==="active"?a.filter(s=>s.type==="day"?os(s.data).isActive:z(s.data).isActive):f==="completed"?a.filter(s=>s.type==="day"?!os(s.data).isActive:!z(s.data).isActive):a,pa=a=>{const s=a.orderId||a.id;P(t=>{const n=new Set(t);return n.has(s)?n.delete(s):n.add(s),n})},ma=()=>{const a=w.length>0?w:b;if(Be)P(new Set),X(!1);else{const s=a.map(t=>t.orderId||t.id);P(new Set(s)),X(!0)}},ua=()=>{P(new Set),X(!1)},rs=()=>{const a=document.getElementById("currentUploadCallCountFrom"),s=document.getElementById("currentUploadCallCountTo"),t=document.getElementById("currentUploadCallCountRangeResult");if(!a||!s||!t)return;const n=a.value,i=s.value,r=n===""?0:parseInt(n)||0,c=i===""?1/0:parseInt(i)||1/0;if(r>c&&i!==""){t.textContent="0",t.style.color="#EF4444",L([]);return}else t.style.color="#4B5CFF";const u=b.filter(d=>{const g=d.totalCallCount||0;return g>=r&&g<=c});t.textContent=u.length,L(u)},ha=()=>{const a=document.getElementById("currentUploadCallCountFrom"),s=document.getElementById("currentUploadCallCountTo");a&&(a.value=""),s&&(s.value=""),L([]);const t=document.getElementById("currentUploadCallCountRangeResult");t&&(t.textContent=b.length,t.style.color="#4B5CFF")},ga=a=>{const s=Ae[a],t=Ue[a];if(!s||!t)return null;const n=s.successCriteria||t.successCriteria||[],i=s.otherCriteria||t.otherCriteria||[],r=s.successCounts||{},c=s.otherCounts||{},u=s.script?.disableUnder35Retries===!1||t.disableUnder35Retries===!1,d=Object.values(r).reduce((x,C)=>x+(C||0),0),g=Object.values(c).reduce((x,C)=>x+(C||0),0),_=x=>x?x.toLowerCase().trim().replace(/[^a-z0-9]/g,""):"",D=[...n,...i],de=D.map(_),xa=D.some((x,C)=>{const h=de[C];if(!((r[x]||0)>0||(c[x]||0)>0))return!1;const xe="addresschange";return h===xe||h==="changeaddress"||h.startsWith(xe)&&h.length<=xe.length+2||h.startsWith("changeaddress")&&h.length<=15}),fa=D.some((x,C)=>{const h=de[C];return(r[x]||0)>0||(c[x]||0)>0?h==="cancellationrequest"||h==="cancelled"||h==="cancellation"||h.includes("cancellation")&&h.length<=20:!1}),ya=D.some((x,C)=>{const h=de[C];return(r[x]||0)>0||(c[x]||0)>0?h==="handlemanually"||h==="manuallyhandle"||h.includes("handlemanually")&&h.length<=15||h.includes("manuallyhandle")&&h.length<=15:!1}),pe=!xa&&(s.addressChange||0)||0,me=!fa&&(s.cancellationRequest||0)||0,ue=!ya&&(s.handleManually||0)||0,J=d+g+pe+me+ue+(s.under35sMaxRetries||0)+(s.notPickedUpMaxRetries||0)+(s.invalid||0),he=(s.notCalledQueued||0)+(s.under35sQueued||0)+(s.notPickedUpQueued||0),cs=d+g+pe+me+ue+(s.under35sMaxRetries||0)+(s.under35sQueued||0),ge=J+(s.under35sQueued||0)+(s.notPickedUpQueued||0),ja=ge>0?Math.round(d/ge*100*10)/10:0,Ca=J+he>0?Math.round(cs/(J+he)*100):0;return{successCriteria:n,otherCriteria:i,successCounts:r,otherCounts:c,disableUnder35:u,addressChange:pe,cancellationRequest:me,handleManually:ue,totalSuccess:d,totalOther:g,totalTerminations:(s.under35sMaxRetries||0)+(s.notPickedUpMaxRetries||0)+(s.invalid||0),totalOngoing:(s.notCalledQueued||0)+(s.under35sQueued||0)+(s.notPickedUpQueued||0),earlyDisconnectMaxRetries:s.under35sMaxRetries||0,notPickedUpMaxRetries:s.notPickedUpMaxRetries||0,invalid:s.invalid||0,notCalledQueued:s.notCalledQueued||0,earlyDisconnectQueued:s.under35sQueued||0,notPickedUpQueued:s.notPickedUpQueued||0,totalOrders:s.uploadedOrders||0,completedTotal:J,queuedTotal:he,customerPickedUp:`${cs} (${Ca}%)`,avgDuration:s.avgDuration||0,conversionRate:s.conversionRate||0,overallConversionRate:`${d}/${ge} (${ja}%)`,totalConnected:s.totalConnected||0,ordersWithCalls:s.ordersWithCalls||0,ongoing:s.ongoing||0,callNotBooked:s.callNotBooked||0}};return e.jsxs("div",{className:"campaigns-page-container",children:[e.jsx("div",{className:"campaigns-page-header",children:e.jsxs("div",{className:"campaigns-header-content",children:[e.jsxs("div",{className:"campaigns-title-section",children:[e.jsxs("div",{className:"campaigns-title-row",children:[e.jsx("h1",{className:"campaigns-page-title",children:"Campaign"}),e.jsx("button",{className:"campaigns-btn-info-compact",onClick:()=>{alert("Campaigns help you organize and manage your call campaigns. Create clips, upload CSVs, and track their progress.")},title:"How it works",children:e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),e.jsx("line",{x1:"12",y1:"8",x2:"12.01",y2:"8"})]})})]}),e.jsx("div",{className:"campaigns-tabs-wrapper",children:e.jsx("div",{className:"campaigns-filter-tabs",children:[{id:"all",label:"All"},{id:"scheduled",label:"Scheduled"},{id:"active",label:"Active"},{id:"completed",label:"Completed"},{id:"clips",label:"Clips"},{id:"test-calls",label:"Test Calls"}].map(a=>e.jsx("button",{type:"button",className:`campaigns-filter-tab ${f===a.id?"active":""}`,onClick:()=>Rs(a.id),children:a.label},a.id))})})]}),e.jsxs("div",{className:"campaigns-header-actions",children:[v&&v.autoCallEnabled&&e.jsx("div",{className:"auto-call-indicator",title:v.autoCallScriptName?`Auto Call Enabled - Script: ${v.autoCallScriptName}`:"Auto Call Enabled - Using Default Script",style:{position:"relative"},children:e.jsx("img",{src:"/images/Raycons Icons Pack (Community)/call-2198440.svg",alt:v.autoCallScriptName?`Auto Call Enabled - Script: ${v.autoCallScriptName}`:"Auto Call Enabled - Using Default Script",title:v.autoCallScriptName?`Auto Call Enabled - Script: ${v.autoCallScriptName}`:"Auto Call Enabled - Using Default Script",style:{width:"20px",height:"20px",display:"block"}})}),e.jsxs("div",{className:"create-button-wrapper",children:[e.jsxs("button",{className:"campaigns-btn campaigns-btn-primary",onClick:()=>S(!U),children:[e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{marginRight:"8px"},children:e.jsx("path",{d:"M12 5v14M5 12h14"})}),"Create",e.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{marginLeft:"8px",transform:U?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s ease"},children:e.jsx("polyline",{points:"6 9 12 15 18 9"})})]}),U&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"dropdown-overlay",onClick:()=>S(!1)}),e.jsxs("div",{className:"create-dropdown-menu",children:[e.jsxs("button",{className:"dropdown-menu-item",onClick:()=>{const a=document.getElementById("campaigns-csv-file-header");a&&a.click(),S(!1)},children:[e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),e.jsx("polyline",{points:"17 8 12 3 7 8"}),e.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]}),e.jsx("span",{children:"Upload CSV"})]}),e.jsxs("button",{className:"dropdown-menu-item",onClick:()=>{const a=`orderName
#1001
#1002
#1003`,s=new Blob([a],{type:"text/csv"}),t=window.URL.createObjectURL(s),n=document.createElement("a");n.href=t,n.download="sample_orders.csv",document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(t),S(!1)},children:[e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),e.jsx("polyline",{points:"17 8 12 3 7 8"}),e.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]}),e.jsx("span",{children:"Download Sample CSV"})]}),e.jsxs("button",{className:"dropdown-menu-item",onClick:()=>{V(!0),S(!1)},children:[e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M12 5v14M5 12h14"})}),e.jsx("span",{children:"Add Orders to Store"})]}),e.jsxs("button",{className:"dropdown-menu-item",onClick:()=>{ss(),S(!1)},children:[e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),e.jsx("polyline",{points:"17 8 12 3 7 8"}),e.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]}),e.jsx("span",{children:"Download Sample"})]})]})]})]}),e.jsx("input",{type:"file",id:"campaigns-csv-file-header",accept:".csv",style:{display:"none"},onChange:Ys})]})]})}),b.length>0&&e.jsxs("div",{className:"current-upload-section",style:{marginTop:"32px",marginBottom:"32px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px",flexWrap:"wrap",gap:"12px"},children:[e.jsx("h2",{style:{margin:0},children:Le?`Orders from Clip: ${Le} (${b.length} orders)`:`Orders from Latest Upload (${b.length} orders)`}),e.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"center",flexWrap:"wrap"},children:[e.jsx("input",{type:"text",placeholder:"Search orders...",value:ee,onChange:a=>Is(a.target.value),style:{padding:"8px 12px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"14px",width:"300px"}}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"8px 12px",border:"1px solid #ddd",borderRadius:"4px"},children:[e.jsx("span",{style:{fontSize:"14px",color:"#6D7175"},children:"Call Count:"}),e.jsx("input",{id:"currentUploadCallCountFrom",type:"number",placeholder:"From",min:"0",onChange:rs,style:{padding:"6px 8px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"14px",width:"80px"}}),e.jsx("span",{style:{fontSize:"14px",color:"#6D7175"},children:"-"}),e.jsx("input",{id:"currentUploadCallCountTo",type:"number",placeholder:"To",min:"0",onChange:rs,style:{padding:"6px 8px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"14px",width:"80px"}}),e.jsx("span",{id:"currentUploadCallCountRangeResult",style:{fontSize:"14px",fontWeight:600,color:"#4B5CFF",minWidth:"30px",textAlign:"center"},children:w.length>0?w.length:b.length}),w.length>0&&e.jsx("button",{onClick:ha,style:{padding:"4px 8px",border:"1px solid #EF4444",background:"#FFFFFF",color:"#EF4444",borderRadius:"4px",fontSize:"12px",cursor:"pointer",marginLeft:"8px"},children:"Clear"})]})]})]}),e.jsxs("div",{className:"orders-table-container",children:[e.jsx("div",{className:"bulk-actions-panel",children:e.jsxs("div",{className:"bulk-actions-content",children:[e.jsxs("span",{className:"selected-count",children:[$.size," orders selected"]}),e.jsxs("div",{className:"bulk-buttons",children:[e.jsx("button",{className:"btn btn-success btn-sm",onClick:()=>ns(Array.from($)),disabled:$.size===0,children:"Bulk AI Call"}),E&&e.jsx("button",{className:"btn btn-primary btn-sm",onClick:()=>oa(E),children:"Bulk Update Addresses"}),e.jsx("button",{className:"btn btn-secondary btn-sm",onClick:ua,disabled:$.size===0,children:"Clear Selection"})]})]})}),e.jsxs("table",{className:"orders-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:e.jsx("input",{type:"checkbox",checked:Be,onChange:ma})}),e.jsx("th",{children:"Order #"}),e.jsx("th",{children:"Customer"}),e.jsx("th",{children:"Phone"}),e.jsx("th",{children:"Address"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Total Calls"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Score"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Sentiment"}),e.jsx("th",{children:"Script"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:(()=>{let a=w.length>0?w:b;if(ee.trim()){const s=ee.toLowerCase();a=a.filter(t=>{const n=(t.orderNumber||t.id||"").toString().toLowerCase(),i=(t.customerName||"").toLowerCase(),r=(t.customerPhone||"").toLowerCase(),c=(t.customerAddress||"").toLowerCase();return n.includes(s)||i.includes(s)||r.includes(s)||c.includes(s)})}return a.map(s=>e.jsxs("tr",{onClick:()=>Q(s.orderId||s.id),style:{cursor:"pointer"},children:[e.jsx("td",{onClick:t=>t.stopPropagation(),children:e.jsx("input",{type:"checkbox",checked:$.has(s.orderId||s.id),onChange:()=>pa(s)})}),e.jsx("td",{style:{fontWeight:600,color:"#202223"},children:s.orderNumber||s.id}),e.jsxs("td",{children:[e.jsx("div",{style:{fontWeight:500,color:"#202223"},children:s.customerName||"N/A"}),s.customerEmail&&e.jsx("div",{style:{fontSize:"12px",color:"#6D7175"},children:s.customerEmail})]}),e.jsx("td",{style:{color:"#6D7175"},children:s.customerPhone||"N/A"}),e.jsxs("td",{className:"address-cell",style:{position:"relative"},children:[e.jsx("div",{style:{color:"#202223",maxWidth:"200px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:s.customerAddress?s.customerAddress.length>30?s.customerAddress.substring(0,30)+"...":s.customerAddress:"N/A"}),s.calls&&s.calls.some(t=>t.newAddress)&&e.jsx("div",{style:{color:"#50B83C",fontSize:"12px",marginTop:"4px"},children:"âœï¸ Updated Address Available"})]}),e.jsx("td",{children:s.totalPrice?`${s.totalPrice} ${s.currency||""}`:"-"}),e.jsx("td",{style:{textAlign:"center"},children:e.jsx("span",{className:"call-count-badge",style:{background:"#f5f5f5",color:"#202223",padding:"4px 8px",borderRadius:"12px",fontSize:"12px",fontWeight:600},children:s.totalCallCount||0})}),e.jsx("td",{children:ra(s.createdAt)}),e.jsx("td",{children:e.jsx("span",{className:`address-score score-${Math.floor(s.onehotscore||0)}`,children:s.onehotscore||"N/A"})}),e.jsx("td",{style:{textAlign:"center"},children:e.jsx("span",{className:"status-badge",children:ls(s.callStatus)})}),e.jsx("td",{style:{textAlign:"center"},children:(()=>{const n=(s.calls&&s.calls.length>0?s.calls[0]:null)?.callSentiment||s.callSentiment||null,i=ca(n);return e.jsxs("span",{className:"sentiment-tag",style:{backgroundColor:i.color},children:[e.jsx("span",{className:"sentiment-bars-container",children:Array.from({length:i.totalBars}).map((r,c)=>e.jsx("span",{className:`sentiment-bar ${c<i.filledBars?"filled":""}`,style:{backgroundColor:c<i.filledBars?i.barColor:"#e5e7eb"}},c))}),e.jsx("span",{className:"sentiment-label",children:i.label})]})})()}),e.jsx("td",{children:s.script?s.script.name:"No Script"}),e.jsxs("td",{style:{textAlign:"center"},onClick:t=>t.stopPropagation(),children:[e.jsx("button",{className:"btn btn-primary btn-sm",onClick:()=>ns([s.orderId||s.id]),children:"AI Call"}),e.jsx("button",{className:"btn btn-secondary btn-sm",onClick:t=>{t.stopPropagation(),Q(s.orderId||s.id)},style:{marginLeft:"8px"},children:"View Calls"})]})]},s.id||s.orderId))})()})]})]})]}),f!=="clips"&&e.jsxs("div",{className:"campaigns-card-unified",children:[e.jsxs("div",{className:"campaigns-section-header",children:[e.jsx("h2",{className:"campaigns-section-title",children:"CSV Upload History"}),e.jsxs("div",{className:"campaigns-section-controls",children:[e.jsxs("div",{className:"campaigns-search-unified",children:[e.jsx(Aa,{size:14,className:"campaigns-search-icon-unified"}),e.jsx("input",{type:"text",className:"campaigns-input-unified",placeholder:"Search by filename...",value:Te,onChange:a=>Ds(a.target.value)})]}),e.jsxs("select",{className:"campaigns-select-unified",value:G,onChange:a=>Es(a.target.value),children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"uploaded",children:"Uploaded"}),e.jsx("option",{value:"processing",children:"Processing"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"failed",children:"Not Picked"})]}),e.jsx("button",{className:"campaigns-btn-unified campaigns-btn-icon-unified",onClick:()=>j(I),title:"Refresh",children:e.jsx(fe,{size:14})})]})]}),e.jsxs("div",{className:"campaigns-card-body-unified",children:[Se?e.jsx("div",{className:"campaigns-loading-unified",children:"Loading CSV history..."}):we.length===0?e.jsx("div",{className:"campaigns-empty-unified",children:"No CSV uploads found."}):e.jsx("div",{className:"campaigns-table-wrapper-unified",children:e.jsxs("table",{className:"csv-history-table-unified",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Filename"}),e.jsx("th",{style:{textAlign:"center"},children:"Status"}),e.jsx("th",{style:{textAlign:"center"},children:"Total Orders"}),e.jsx("th",{style:{textAlign:"center"},children:"Progress"}),e.jsx("th",{style:{textAlign:"center"},children:"Speed"}),e.jsx("th",{style:{textAlign:"center"},children:"Actions"})]})}),e.jsx("tbody",{children:(()=>{const a=Fs.map(n=>({type:"day",date:new Date(n.date),data:n})),s=we.filter(n=>{const i=Te.toLowerCase(),r=!i||n.filename&&n.filename.toLowerCase().includes(i)||n.shop&&n.shop.toLowerCase().includes(i),c=G==="all"||n.status&&n.status.toLowerCase()===G.toLowerCase();return r&&c}).map(n=>({type:"csv",date:n.createdAt?new Date(n.createdAt):new Date(0),data:n}));let t=[...a,...s].sort((n,i)=>i.date-n.date);return t=da(t),Ps||Se?e.jsx("tr",{children:e.jsx("td",{colSpan:6,style:{textAlign:"center",padding:"20px"},children:"Loading..."})}):t.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,style:{textAlign:"center",padding:"20px",color:"#6b7280"},children:"No campaigns found"})}):t.map(n=>{if(n.type==="day"){const i=n.data,r=new Date,c=new Date(i.date),u=r.toDateString()===c.toDateString(),d=u?"Ongoing":"Completed",g=u?"#10b981":"#ef4444";return e.jsxs("tr",{className:"csv-row non-campaign-row",onClick:()=>N(`/non-campaign-orders?shop=${encodeURIComponent(o)}&startDate=${i.startDate}&endDate=${i.endDate}`),style:{cursor:"pointer",backgroundColor:"#f8f9fa"},children:[e.jsxs("td",{className:"csv-table-cell-filename",children:[e.jsx("div",{className:"filename-compact",style:{fontWeight:"600",color:"#1f2937"},children:i.displayName}),e.jsx("div",{className:"shop-name-compact",style:{fontSize:"12px",color:"#6b7280"},children:"auto called orders"})]}),e.jsx("td",{style:{textAlign:"center"},children:e.jsxs("div",{className:"campaign-status-with-label",children:[e.jsx("span",{className:"campaign-status-dot",style:{backgroundColor:g}}),e.jsx("span",{className:"campaign-status-text",children:d})]})}),e.jsx("td",{style:{textAlign:"center",fontWeight:"bold"},children:i.orderCount}),e.jsxs("td",{style:{textAlign:"center"},children:[e.jsx("div",{className:"progress-info",children:i.orderCount||0}),e.jsx("div",{className:"progress-bar-container",children:e.jsx("div",{className:"progress-bar",style:{width:"100%",backgroundColor:u?"#10b981":"#ef4444"}})})]}),e.jsxs("td",{style:{textAlign:"center"},children:[e.jsxs("span",{className:"campaign-speed-display",title:`${i.totalCalls||0} total calls, ${i.pickedUpCalls||0} picked up, ${i.confirmedOrders||0} confirmed`,children:[i.confirmationRate||0,"%"]}),e.jsxs("div",{style:{fontSize:"11px",color:"#6b7280",marginTop:"2px"},children:[i.confirmedOrders||0,"/",i.pickedUpCalls||0," confirmed"]})]}),e.jsx("td",{style:{textAlign:"center"},children:e.jsx("button",{className:"campaign-action-btn",onClick:_=>{_.stopPropagation(),N(`/non-campaign-orders?shop=${encodeURIComponent(o)}&startDate=${i.startDate}&endDate=${i.endDate}`)},title:`View ${i.displayName} orders`,children:e.jsx(ye,{size:14})})})]},`day-${i.date}`)}else{const i=n.data,r=K===i.id;fs[i.id],Ae[i.id],Ue[i.id],ga(i.id);const c=Cs[i.id],u=bs[i.id];return e.jsxs(Na.Fragment,{children:[e.jsxs("tr",{className:"csv-row","data-upload-id":i.id,onClick:()=>N(`/campaigns/${i.id}?shop=${encodeURIComponent(o)}`),style:{cursor:"pointer"},children:[e.jsxs("td",{className:"csv-table-cell-filename",children:[e.jsx("div",{className:"filename-compact",style:{fontWeight:"600",color:"#1f2937"},children:i.filename}),e.jsx("div",{className:"shop-name-compact",style:{fontSize:"12px",color:"#6b7280"},children:i.shop||"N/A"})]}),e.jsx("td",{style:{textAlign:"center"},children:(()=>{const d=z(i);return e.jsxs("div",{className:"campaign-status-with-label",children:[e.jsx("span",{className:"campaign-status-dot",style:{backgroundColor:d.dotColor}}),e.jsx("span",{className:"campaign-status-text",children:d.label})]})})()}),e.jsx("td",{style:{textAlign:"center",fontWeight:"bold"},children:i.totalOrders||0}),e.jsxs("td",{style:{textAlign:"center"},children:[e.jsxs("div",{className:"progress-info",children:[i.completed||0," / ",i.totalOrders||0]}),e.jsx("div",{className:"progress-bar-container",children:e.jsx("div",{className:"progress-bar",style:{width:`${i.progress||0}%`,backgroundColor:(i.queuedOrders||0)===0?"#ef4444":"#10b981"}})})]}),e.jsx("td",{style:{textAlign:"center"},children:(()=>{let d="â€”";if(i.createdAt&&i.completed){const g=new Date(i.createdAt),D=Math.max((new Date-g)/(1e3*60*60),.01);d=Math.round((i.completed||0)/D)}return e.jsx("span",{className:"campaign-speed-display",title:`${d} orders/hour`,children:d})})()}),e.jsx("td",{className:"csv-table-cell-actions-unified",onClick:d=>d.stopPropagation(),children:e.jsxs("div",{className:"campaigns-actions-group-unified",children:[e.jsx("button",{className:"campaigns-btn-unified campaigns-btn-text-unified",onClick:()=>{window.open(`/api/csv-zip?csvUploadId=${i.id}&shop=${encodeURIComponent(o)}`,"_blank")},title:"Download CSV",children:e.jsx(Ua,{size:14})}),e.jsx("button",{className:"campaigns-btn-unified campaigns-btn-text-unified",onClick:()=>na(i.id,i.filename),title:"Rename",children:e.jsx(Oa,{size:14})}),e.jsx("button",{className:"campaigns-btn-unified campaigns-btn-text-unified",onClick:d=>{d.stopPropagation(),Bs(i),M(!0)},title:"View Details",children:e.jsx(Ea,{size:14})}),e.jsx("button",{className:"campaigns-btn-unified campaigns-btn-text-unified campaigns-btn-danger-unified",onClick:()=>ia(i.id),title:"Delete",children:e.jsx($a,{size:14})})]})})]}),r&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,style:{padding:0,backgroundColor:"#f9fafb"},children:e.jsx("div",{style:{padding:"20px"},children:c||u||Vs?e.jsx("div",{style:{textAlign:"center",padding:"20px"},children:"Loading..."}):e.jsx("div",{children:ce.data.length>0&&Ws===i.id&&e.jsx("div",{style:{marginBottom:"24px"},children:e.jsx(ka,{data:ce.data,labels:ce.labels})})})})})})]},i.id)}})})()})]})}),k&&k.totalPages>1&&e.jsxs("div",{className:"pagination",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>j(I-1),disabled:!k.hasPrev,children:"Previous"}),e.jsxs("span",{children:["Page ",k.currentPage," of ",k.totalPages]}),e.jsx("button",{className:"btn btn-secondary",onClick:()=>j(I+1),disabled:!k.hasNext,children:"Next"})]})]})]}),f==="test-calls"&&e.jsxs("div",{className:"campaigns-card-unified",style:{marginTop:"32px"},children:[e.jsxs("div",{className:"campaigns-section-header",children:[e.jsx("h2",{className:"campaigns-section-title",children:"Test Calls"}),e.jsx("div",{className:"campaigns-section-controls",children:e.jsx("button",{className:"campaigns-btn-unified campaigns-btn-icon-unified",onClick:()=>{Ze(),Xe()},title:"Refresh",children:e.jsx(fe,{size:14})})})]}),e.jsx("div",{className:"campaigns-card-body-unified",children:Ls||Ms?e.jsx("div",{className:"campaigns-loading-unified",children:"Loading test calls..."}):Qe.length===0&&Je.length===0?e.jsx("div",{className:"campaigns-empty-unified",children:"No test calls found."}):e.jsx("div",{className:"campaigns-table-container",children:e.jsxs("table",{className:"campaigns-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Filename / Date"}),e.jsx("th",{style:{textAlign:"center"},children:"Status"}),e.jsx("th",{style:{textAlign:"center"},children:"Test Orders"}),e.jsx("th",{style:{textAlign:"center"},children:"Total Calls"}),e.jsx("th",{style:{textAlign:"center"},children:"Actions"})]})}),e.jsxs("tbody",{children:[Je.map(a=>{const s=z(a);return e.jsxs("tr",{className:"csv-row",onClick:()=>N(`/campaigns/${a.id}?shop=${encodeURIComponent(o)}`),style:{cursor:"pointer"},children:[e.jsxs("td",{className:"csv-table-cell-filename",children:[e.jsx("div",{className:"filename-compact",style:{fontWeight:"600",color:"#1f2937"},children:a.filename}),e.jsx("div",{className:"shop-name-compact",style:{fontSize:"12px",color:"#6b7280"},children:"test campaign"})]}),e.jsx("td",{style:{textAlign:"center"},children:e.jsxs("div",{className:"campaign-status-with-label",children:[e.jsx("span",{className:"campaign-status-dot",style:{backgroundColor:s.dotColor}}),e.jsx("span",{className:"campaign-status-text",children:s.label})]})}),e.jsx("td",{style:{textAlign:"center",fontWeight:"bold"},children:a.testOrderCount||0}),e.jsx("td",{style:{textAlign:"center"},children:a.testCallsCount||0}),e.jsx("td",{style:{textAlign:"center"},children:e.jsx("button",{className:"campaign-action-btn",onClick:t=>{t.stopPropagation(),N(`/campaigns/${a.id}?shop=${encodeURIComponent(o)}`)},title:`View ${a.filename}`,children:e.jsx(ye,{size:14})})})]},`test-csv-${a.id}`)}),Qe.map(a=>e.jsxs("tr",{className:"csv-row",onClick:()=>N(`/all-orders?shop=${encodeURIComponent(o)}&isTestOrder=true&startDate=${a.startDate}&endDate=${a.endDate}`),style:{cursor:"pointer"},children:[e.jsxs("td",{className:"csv-table-cell-filename",children:[e.jsx("div",{className:"filename-compact",style:{fontWeight:"600",color:"#1f2937"},children:a.displayName}),e.jsx("div",{className:"shop-name-compact",style:{fontSize:"12px",color:"#6b7280"},children:"test calls"})]}),e.jsx("td",{style:{textAlign:"center"},children:e.jsxs("div",{className:"campaign-status-with-label",children:[e.jsx("span",{className:"campaign-status-dot",style:{backgroundColor:"#10b981"}}),e.jsx("span",{className:"campaign-status-text",children:"Active"})]})}),e.jsx("td",{style:{textAlign:"center",fontWeight:"bold"},children:a.orderCount}),e.jsx("td",{style:{textAlign:"center"},children:a.totalCalls||0}),e.jsx("td",{style:{textAlign:"center"},children:e.jsx("button",{className:"campaign-action-btn",onClick:s=>{s.stopPropagation(),N(`/all-orders?shop=${encodeURIComponent(o)}&isTestOrder=true&startDate=${a.startDate}&endDate=${a.endDate}`)},title:`View ${a.displayName} test calls`,children:e.jsx(ye,{size:14})})})]},`test-${a.date}`))]})]})})})]}),f==="clips"&&e.jsxs("div",{className:"campaigns-card-unified",style:{marginTop:"32px"},children:[e.jsxs("div",{className:"campaigns-section-header",children:[e.jsx("h2",{className:"campaigns-section-title",children:"Clips"}),e.jsx("div",{className:"campaigns-section-controls",children:e.jsx("button",{className:"campaigns-btn-unified campaigns-btn-icon-unified",onClick:()=>q(),title:"Refresh",children:e.jsx(fe,{size:14})})})]}),e.jsx("div",{className:"campaigns-card-body-unified",children:Os?e.jsx("div",{className:"campaigns-loading-unified",children:"Loading clips..."}):se.length===0?e.jsx("div",{className:"campaigns-empty-unified",children:"No clips found. Create clips from the All Orders tab."}):e.jsx("div",{className:"campaigns-clips-grid",children:se.map(a=>e.jsxs("div",{className:"campaigns-clip-card",onClick:()=>Ge(a.id),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"12px"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontSize:"16px",fontWeight:600,marginBottom:"8px",color:"#1f2937"},children:a.name}),a.description&&e.jsx("div",{style:{fontSize:"13px",color:"#6b7280",marginBottom:"8px"},children:a.description})]}),e.jsx("button",{onClick:s=>{s.stopPropagation(),es(a.id,s)},style:{background:"none",border:"none",cursor:"pointer",fontSize:"18px",color:"#EF4444",padding:"4px",borderRadius:"4px",marginLeft:"8px"},onMouseEnter:s=>{s.currentTarget.style.background="#FEE2E2"},onMouseLeave:s=>{s.currentTarget.style.background="none"},title:"Delete clip",children:"Ã—"})]}),e.jsxs("div",{style:{fontSize:"14px",color:"#9CA3AF",marginBottom:"4px"},children:[a.orderCount||0," orders"]}),e.jsx("div",{style:{fontSize:"12px",color:"#9CA3AF"},children:a.createdAt?new Date(a.createdAt).toLocaleDateString():""})]},a.id))})})]}),$s&&m&&e.jsx("div",{className:"campaigns-modal-overlay",onClick:()=>M(!1),children:e.jsxs("div",{className:"campaigns-modal-content",onClick:a=>a.stopPropagation(),children:[e.jsxs("div",{className:"campaigns-modal-header",children:[e.jsx("h3",{className:"campaigns-modal-title",children:"Upload Details"}),e.jsx("button",{className:"campaigns-modal-close",onClick:()=>M(!1),children:e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),e.jsxs("div",{className:"campaigns-modal-body",children:[e.jsxs("div",{className:"campaigns-info-section",children:[e.jsx("h4",{className:"campaigns-info-section-title",children:"File Information"}),e.jsxs("div",{className:"campaigns-info-grid-two-col",children:[e.jsxs("div",{className:"campaigns-info-row",children:[e.jsx("span",{className:"campaigns-info-label",children:"Filename"}),e.jsx("span",{className:"campaigns-info-value",children:m.filename||"N/A"})]}),e.jsxs("div",{className:"campaigns-info-row",children:[e.jsx("span",{className:"campaigns-info-label",children:"Shop"}),e.jsx("span",{className:"campaigns-info-value",children:m.shop||"N/A"})]})]})]}),e.jsx("div",{className:"campaigns-info-divider"}),e.jsxs("div",{className:"campaigns-info-section",children:[e.jsx("h4",{className:"campaigns-info-section-title",children:"Status"}),e.jsxs("div",{className:"campaigns-info-grid-two-col",children:[e.jsxs("div",{className:"campaigns-info-row",children:[e.jsx("span",{className:"campaigns-info-label",children:"Status"}),e.jsx("span",{className:"campaigns-info-value",children:(()=>{const a=z(m);return e.jsx("span",{className:"campaigns-status-badge",style:{backgroundColor:a.dotColor==="#10b981"?"#ecfdf5":"#fef2f2",color:a.dotColor==="#10b981"?"#059669":"#dc2626"},children:a.label})})()})]}),e.jsxs("div",{className:"campaigns-info-row",children:[e.jsx("span",{className:"campaigns-info-label",children:"Upload Date"}),e.jsx("span",{className:"campaigns-info-value",children:is(m.createdAt)})]})]})]}),e.jsx("div",{className:"campaigns-info-divider"}),e.jsxs("div",{className:"campaigns-info-section",children:[e.jsx("h4",{className:"campaigns-info-section-title",children:"Progress"}),e.jsxs("div",{className:"campaigns-info-grid-two-col",children:[e.jsxs("div",{className:"campaigns-info-row",children:[e.jsx("span",{className:"campaigns-info-label",children:"Total Orders"}),e.jsx("span",{className:"campaigns-info-value campaigns-info-value-emphasis",children:m.totalOrders||0})]}),e.jsxs("div",{className:"campaigns-info-row",children:[e.jsx("span",{className:"campaigns-info-label",children:"Progress"}),e.jsxs("span",{className:"campaigns-info-value",children:[m.completed||0," / ",m.total||m.totalOrders||0]})]}),e.jsxs("div",{className:"campaigns-info-row",children:[e.jsx("span",{className:"campaigns-info-label",children:"Progress Percentage"}),e.jsxs("span",{className:"campaigns-info-value campaigns-info-value-emphasis",children:[m.progress||0,"%"]})]}),e.jsxs("div",{className:"campaigns-info-row",children:[e.jsx("span",{className:"campaigns-info-label",children:"Speed"}),e.jsx("span",{className:"campaigns-info-value",children:(()=>{let a=0;if(m.createdAt&&m.completed){const s=new Date(m.createdAt),n=Math.max((new Date-s)/(1e3*60*60),.01);a=Math.round((m.completed||0)/n)}return a>0?`${a} orders/hour`:"â€”"})()})]})]})]}),(m.etaStatus||m.eta&&m.etaStatus!=="completed")&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"campaigns-info-divider"}),e.jsxs("div",{className:"campaigns-info-section",children:[e.jsx("h4",{className:"campaigns-info-section-title",children:"System Information"}),e.jsxs("div",{className:"campaigns-info-grid-two-col",children:[m.etaStatus&&e.jsxs("div",{className:"campaigns-info-row",children:[e.jsx("span",{className:"campaigns-info-label",children:"ETA Status"}),e.jsx("span",{className:"campaigns-info-value",children:m.etaStatus})]}),m.eta&&m.etaStatus!=="completed"&&e.jsxs("div",{className:"campaigns-info-row",children:[e.jsx("span",{className:"campaigns-info-label",children:"Estimated Time"}),e.jsx("span",{className:"campaigns-info-value",children:m.eta})]})]})]})]})]}),e.jsx("div",{className:"campaigns-modal-footer",children:e.jsx("button",{className:"campaigns-btn-unified campaigns-btn-primary-unified",onClick:()=>M(!1),children:"Close"})})]})}),Ns&&e.jsx("div",{className:"modal-overlay",onClick:()=>R(!1),children:e.jsxs("div",{className:"modal-content",onClick:a=>a.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("h3",{children:["Bulk AI Call - ",Z.length," Orders"]}),e.jsx("button",{className:"modal-close",onClick:()=>R(!1),children:"Ã—"})]}),e.jsxs("div",{className:"modal-body",children:[e.jsx("p",{children:"Choose a script to use for the selected orders:"}),e.jsx("div",{className:"scripts-list",children:O.length>0?O.map(a=>e.jsxs("div",{className:"script-option",onClick:()=>ea(a.id,a.name),children:[e.jsx("div",{className:"script-name",children:a.name}),e.jsx("div",{className:"script-preview",children:a.content?a.content.substring(0,100)+(a.content.length>100?"...":""):"No content"})]},a.id)):e.jsx("p",{style:{textAlign:"center",color:"#666"},children:"No scripts available. Please create a script first."})}),e.jsx("div",{className:"modal-footer",children:e.jsx("button",{className:"btn btn-secondary",onClick:()=>R(!1),children:"Cancel"})})]})]})}),ws&&e.jsx("div",{className:"modal-overlay",children:e.jsx("div",{className:"modal-content",children:e.jsxs("div",{className:"modal-body",style:{textAlign:"center"},children:[e.jsx("h3",{children:"Processing Bulk AI Call"}),e.jsxs("p",{children:["Setting ",Z.length," orders in queue..."]}),e.jsx(ps,{size:"medium"})]})})}),Ss&&e.jsx("div",{className:"campaigns-modal-overlay",onClick:()=>A(!1),children:e.jsxs("div",{className:"campaigns-modal-content order-details-modal-wide",onClick:a=>a.stopPropagation(),children:[e.jsxs("div",{className:"campaigns-modal-header",children:[e.jsx("h3",{className:"campaigns-modal-title",children:"Order Details"}),e.jsx("button",{className:"campaigns-modal-close",onClick:()=>A(!1),children:e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),Us?e.jsx("div",{className:"order-details-loading",children:e.jsx(ps,{size:"medium",text:"Loading order details..."})}):p&&e.jsxs("div",{className:"campaigns-modal-body",children:[e.jsxs("div",{className:"campaigns-info-section",children:[e.jsx("h4",{className:"campaigns-info-section-title",children:"Customer Information"}),e.jsxs("div",{className:"campaigns-info-grid-two-col",children:[e.jsxs("div",{className:"campaigns-info-row",children:[e.jsx("span",{className:"campaigns-info-label",children:"Name"}),e.jsx("span",{className:"campaigns-info-value",children:p.customerName||"N/A"})]}),e.jsxs("div",{className:"campaigns-info-row",children:[e.jsx("span",{className:"campaigns-info-label",children:"Phone"}),e.jsx("span",{className:"campaigns-info-value",children:p.customerPhone||"N/A"})]}),e.jsxs("div",{className:"campaigns-info-row",children:[e.jsx("span",{className:"campaigns-info-label",children:"Email"}),e.jsx("span",{className:"campaigns-info-value",children:p.customerEmail||"N/A"})]})]})]}),e.jsx("div",{className:"campaigns-info-divider"}),e.jsxs("div",{className:"campaigns-info-section",children:[e.jsx("h4",{className:"campaigns-info-section-title",children:"Address Information"}),e.jsxs("div",{className:"campaigns-info-grid-two-col",children:[e.jsxs("div",{className:"campaigns-info-row",style:{gridColumn:"1 / -1"},children:[e.jsx("span",{className:"campaigns-info-label",children:"Current Address"}),e.jsx("span",{className:"campaigns-info-value",children:p.customerAddress||"N/A"})]}),y.some(a=>a.newAddress)&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"campaigns-info-row",style:{gridColumn:"1 / -1"},children:[e.jsx("span",{className:"campaigns-info-label",children:"Updated Address"}),e.jsx("span",{className:"campaigns-info-value",children:y.find(a=>a.newAddress)?.newAddress||"N/A"})]}),e.jsx("div",{className:"campaigns-info-row",style:{gridColumn:"1 / -1",marginTop:"8px"},children:e.jsxs("div",{style:{display:"flex",gap:"12px",flexWrap:"wrap"},children:[e.jsx("button",{className:"campaigns-btn-unified campaigns-btn-secondary-unified",onClick:()=>ta(y.find(a=>a.newAddress)?.id,p.customerAddress,y.find(a=>a.newAddress)?.newAddress),style:{padding:"8px 16px",fontSize:"13px"},children:"Edit Address"}),e.jsx("button",{className:"campaigns-btn-unified campaigns-btn-primary-unified",onClick:()=>aa(p.orderId||p.id,y.find(a=>a.newAddress)?.newAddress),style:{padding:"8px 16px",fontSize:"13px"},children:"Update in Shopify"})]})})]})]})]}),e.jsx("div",{className:"campaigns-info-divider"}),e.jsxs("div",{className:"campaigns-info-section",children:[e.jsx("h4",{className:"campaigns-info-section-title",children:"Order Information"}),e.jsxs("div",{className:"campaigns-info-grid-two-col",children:[e.jsxs("div",{className:"campaigns-info-row",children:[e.jsx("span",{className:"campaigns-info-label",children:"Order Number"}),e.jsxs("span",{className:"campaigns-info-value",children:["#",p.orderNumber||"N/A"]})]}),e.jsxs("div",{className:"campaigns-info-row",children:[e.jsx("span",{className:"campaigns-info-label",children:"Amount"}),e.jsx("span",{className:"campaigns-info-value",children:p.totalPrice?`${p.totalPrice} ${p.currency||""}`:"N/A"})]}),e.jsxs("div",{className:"campaigns-info-row",children:[e.jsx("span",{className:"campaigns-info-label",children:"Date"}),e.jsx("span",{className:"campaigns-info-value",children:is(p.createdAt)})]}),e.jsxs("div",{className:"campaigns-info-row",children:[e.jsx("span",{className:"campaigns-info-label",children:"Status"}),e.jsx("span",{className:"campaigns-info-value",children:e.jsx("span",{className:"campaigns-status-badge",style:{backgroundColor:"#fef2f2",color:"#dc2626"},children:ls(p.callStatus)})})]})]})]}),y.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"campaigns-info-divider"}),e.jsxs("div",{className:"campaigns-info-section",children:[e.jsxs("h4",{className:"campaigns-info-section-title",children:["Call History (",y.length," ",y.length===1?"call":"calls",")"]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:y.map((a,s)=>e.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:"8px",padding:"16px",background:"#f9fafb"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"12px"},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{fontSize:"14px",fontWeight:600,color:"#111827",marginBottom:"4px"},children:["Call #",s+1]}),e.jsxs("div",{style:{fontSize:"12px",color:"#6b7280",display:"flex",gap:"8px",flexWrap:"wrap"},children:[e.jsx("span",{children:sa(a.createdAt||a.startedAt)}),e.jsx("span",{children:"â€¢"}),e.jsxs("span",{children:["Duration: ",a.callDuration?a.callDuration+"s":"N/A"]})]})]}),e.jsx("span",{className:"campaigns-status-badge",style:{backgroundColor:"#f3f4f6",color:"#374151",fontSize:"12px"},children:a.callStatus||"Unknown"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px 24px",marginTop:"12px"},children:[p.script&&e.jsxs("div",{className:"campaigns-info-row",children:[e.jsx("span",{className:"campaigns-info-label",children:"Script"}),e.jsx("span",{className:"campaigns-info-value",children:p.script.name||"N/A"})]}),a.callOutcomeCategory&&e.jsxs("div",{className:"campaigns-info-row",children:[e.jsx("span",{className:"campaigns-info-label",children:"Outcome"}),e.jsx("span",{className:"campaigns-info-value",children:a.callOutcomeCategory})]}),a.callInterestScore&&e.jsxs("div",{className:"campaigns-info-row",children:[e.jsx("span",{className:"campaigns-info-label",children:"Interest Score"}),e.jsx("span",{className:"campaigns-info-value campaigns-info-value-emphasis",children:a.callInterestScore})]}),a.addressChangeRequested&&e.jsxs("div",{className:"campaigns-info-row",children:[e.jsx("span",{className:"campaigns-info-label",children:"Address Change"}),e.jsx("span",{className:"campaigns-info-value",children:"Requested"})]}),a.newAddress&&e.jsxs("div",{className:"campaigns-info-row",style:{gridColumn:"1 / -1"},children:[e.jsx("span",{className:"campaigns-info-label",children:"New Address"}),e.jsx("span",{className:"campaigns-info-value",style:{whiteSpace:"pre-wrap",wordBreak:"break-word"},children:a.newAddress})]})]}),a.audioUrl&&a.audioUrl.startsWith("https://")&&e.jsxs("div",{style:{marginTop:"12px",paddingTop:"12px",borderTop:"1px solid #e5e7eb"},children:[e.jsx("span",{className:"campaigns-info-label",style:{display:"block",marginBottom:"8px"},children:"Audio"}),e.jsx("audio",{controls:!0,style:{width:"100%",height:"32px",marginBottom:"8px"},children:e.jsx("source",{src:a.audioUrl,type:"audio/mpeg"})}),e.jsx("button",{className:"campaigns-btn-unified campaigns-btn-secondary-unified",onClick:()=>la(a.audioUrl,a.callId||a.id),style:{padding:"6px 12px",fontSize:"12px"},children:"Download Audio"})]}),a.transcript&&e.jsxs("div",{style:{marginTop:"12px",paddingTop:"12px",borderTop:"1px solid #e5e7eb"},children:[e.jsx("span",{className:"campaigns-info-label",style:{display:"block",marginBottom:"12px"},children:"Transcript"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px",maxHeight:"300px",overflowY:"auto",padding:"8px",background:"#f9fafb",borderRadius:"8px"},children:Sa(a.transcript).map((t,n)=>e.jsx("div",{style:{display:"flex",justifyContent:t.role==="user"?"flex-end":"flex-start",alignItems:"flex-start",gap:"8px"},children:e.jsx("div",{style:{maxWidth:"75%",padding:"10px 14px",borderRadius:"12px",fontSize:"13px",lineHeight:"1.5",wordBreak:"break-word",whiteSpace:"pre-wrap",background:t.role==="user"?"#4B5CFF":"#ffffff",color:t.role==="user"?"#ffffff":"#111827",border:t.role==="agent"?"1px solid #e5e7eb":"none",boxShadow:t.role==="agent"?"0 1px 2px rgba(0,0,0,0.05)":"none"},children:t.content})},n))})]}),a.callSummary&&e.jsxs("div",{style:{marginTop:"12px",paddingTop:"12px",borderTop:"1px solid #e5e7eb"},children:[e.jsx("span",{className:"campaigns-info-label",style:{display:"block",marginBottom:"8px"},children:"Summary"}),e.jsx("div",{style:{padding:"12px",background:"white",borderRadius:"6px",fontSize:"13px",lineHeight:"1.6",color:"#374151",whiteSpace:"pre-wrap",wordBreak:"break-word"},children:a.callSummary})]})]},a.id||s))})]})]}),y.length===0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"campaigns-info-divider"}),e.jsx("div",{className:"campaigns-info-section",children:e.jsx("div",{style:{textAlign:"center",padding:"40px",color:"#6b7280"},children:e.jsx("p",{style:{margin:0},children:"No calls made for this order yet."})})})]})]}),e.jsx("div",{className:"campaigns-modal-footer",children:e.jsx("button",{className:"campaigns-btn-unified campaigns-btn-primary-unified",onClick:()=>A(!1),children:"Close"})})]})}),Fe&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"20px"},children:e.jsxs("div",{style:{background:"white",borderRadius:"8px",width:"90%",maxWidth:"800px",maxHeight:"80vh",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)",display:"flex",flexDirection:"column"},children:[e.jsxs("div",{style:{padding:"20px",borderBottom:"1px solid #E5E7EB",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h3",{style:{fontSize:"20px",fontWeight:600,margin:0},children:"All Clips"}),e.jsx("button",{onClick:()=>{Pe(!1),B([])},style:{background:"none",border:"none",fontSize:"24px",cursor:"pointer",color:"#6B7280",padding:"4px 8px"},children:"Ã—"})]}),e.jsx("div",{style:{padding:"20px",overflowY:"auto",flex:1},children:te.length>0?e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:"16px"},children:te.map(a=>e.jsxs("div",{onClick:()=>{Ge(a.id),Pe(!1),B([])},style:{padding:"16px",background:"white",borderRadius:"8px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",cursor:"pointer",transition:"all 0.2s",border:"1px solid #E5E7EB",position:"relative"},onMouseEnter:s=>{s.currentTarget.style.boxShadow="0 4px 6px rgba(0,0,0,0.15)",s.currentTarget.style.transform="translateY(-2px)"},onMouseLeave:s=>{s.currentTarget.style.boxShadow="0 1px 3px rgba(0,0,0,0.1)",s.currentTarget.style.transform="translateY(0)"},children:[e.jsx("button",{onClick:s=>es(a.id,s),style:{position:"absolute",top:"8px",right:"8px",background:"none",border:"none",cursor:"pointer",fontSize:"18px",color:"#EF4444",padding:"4px",borderRadius:"4px"},onMouseEnter:s=>{s.currentTarget.style.background="#FEE2E2"},onMouseLeave:s=>{s.currentTarget.style.background="none"},children:"Ã—"}),e.jsx("div",{style:{fontSize:"16px",fontWeight:600,marginBottom:"8px",paddingRight:"24px"},children:a.name}),a.description&&e.jsx("div",{style:{fontSize:"12px",color:"#6B7280",marginBottom:"8px"},children:a.description}),e.jsxs("div",{style:{fontSize:"12px",color:"#9CA3AF"},children:[a.orderCount||0," orders"]}),e.jsx("div",{style:{fontSize:"11px",color:"#9CA3AF",marginTop:"4px"},children:a.createdAt?new Date(a.createdAt).toLocaleDateString():""})]},a.id))}):e.jsx("div",{style:{padding:"40px",textAlign:"center",color:"#6B7280"},children:"No clips found"})})]})}),Ts&&e.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"rgba(0, 0, 0, 0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e4},children:e.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"24px",maxWidth:"600px",width:"90%",maxHeight:"80vh",overflowY:"auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[e.jsx("h2",{style:{margin:0,fontSize:"20px",fontWeight:600},children:"Add Orders to Store"}),e.jsx("button",{onClick:()=>{V(!1),W(null),H(null)},style:{background:"none",border:"none",fontSize:"24px",cursor:"pointer",color:"#6B7280",padding:"4px 8px"},children:"Ã—"})]}),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"8px",fontWeight:500,fontSize:"14px"},children:"Upload CSV File"}),e.jsx("input",{type:"file",accept:".csv",onChange:a=>W(a.target.files[0]),style:{width:"100%",padding:"8px",border:"1px solid #D1D5DB",borderRadius:"6px",fontSize:"14px"}}),e.jsx("p",{style:{marginTop:"8px",fontSize:"12px",color:"#6B7280"},children:"Required columns: customerPhone (10-14 digits), customerName, customerAddress, totalPrice, currency, orderNumber (optional)"}),e.jsx("button",{onClick:ss,style:{marginTop:"8px",padding:"6px 12px",background:"#F3F4F6",border:"1px solid #D1D5DB",borderRadius:"6px",fontSize:"12px",cursor:"pointer",color:"#374151"},children:"Download Sample CSV"})]}),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"8px",fontWeight:500,fontSize:"14px"},children:"Select Script (Optional - orders will be queued if selected)"}),e.jsxs("select",{value:ie||"",onChange:a=>H(a.target.value||null),style:{width:"100%",padding:"8px",border:"1px solid #D1D5DB",borderRadius:"6px",fontSize:"14px"},children:[e.jsx("option",{value:"",children:"No script (orders will not be queued)"}),O.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]}),e.jsx("p",{style:{marginTop:"8px",fontSize:"12px",color:"#6B7280"},children:"If a script is selected, orders will be automatically queued for calling"})]}),e.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[e.jsx("button",{onClick:()=>{V(!1),W(null),H(null)},style:{padding:"10px 20px",background:"white",border:"1px solid #D1D5DB",borderRadius:"6px",fontSize:"14px",cursor:"pointer",color:"#374151"},disabled:T,children:"Cancel"}),e.jsx("button",{onClick:Ks,disabled:!ne||T,style:{padding:"10px 20px",background:T?"#9CA3AF":"#2563EB",border:"none",borderRadius:"6px",fontSize:"14px",cursor:T?"not-allowed":"pointer",color:"white",fontWeight:500},children:T?"Uploading...":"Upload Orders"})]})]})})]})};export{it as default};
