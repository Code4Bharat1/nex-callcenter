import{u as N,r as s,j as t}from"./index-B_YWOrie.js";const I=({shop:L})=>{const r=N(),[i,a]=s.useState(!1),[q,g]=s.useState(!1),[h,m]=s.useState(!0),[f,d]=s.useState(!1),[w,v]=s.useState(()=>{const e=localStorage.getItem("floatingWidgetVisible");return e!==null?e==="true":!1}),[c,x]=s.useState(!1),S=s.useRef(null),k=s.useRef(null),u=s.useRef(null);s.useEffect(()=>{const e=()=>{const n=localStorage.getItem("floatingWidgetVisible");v(n!==null?n==="true":!0)};return window.addEventListener("floatingWidgetVisibilityChanged",e),()=>window.removeEventListener("floatingWidgetVisibilityChanged",e)},[]),s.useEffect(()=>{u.current&&u.current!==r.pathname&&(m(!0),u.current=null)},[r.pathname]),s.useEffect(()=>{const e=()=>{const l=document.querySelector(".floating-test-call-modal"),p=document.querySelector(".help-support-window-v2"),W=l&&window.getComputedStyle(l).display!=="none",E=p&&window.getComputedStyle(p).display!=="none",b=W||E;x(b),b?(d(!0),a(!0)):i||d(!1)};e();const n=setInterval(e,100),o=new MutationObserver(e);return o.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["style","class"]}),()=>{clearInterval(n),o.disconnect()}},[i]);const y=()=>{a(!i),d(!f)},C=()=>{console.log("[UnifiedWidget] Test button clicked"),setTimeout(()=>{const e=document.querySelector(".hidden-widget-buttons .floating-test-call-btn");console.log("[UnifiedWidget] Found test button:",e),e?(console.log("[UnifiedWidget] Clicking test button"),e.click()):console.error("[UnifiedWidget] Test button not found in DOM")},100)},j=()=>{console.log("[UnifiedWidget] Support button clicked"),setTimeout(()=>{const e=document.querySelector(".hidden-widget-buttons .help-support-widget-btn");console.log("[UnifiedWidget] Found support button:",e),e?(console.log("[UnifiedWidget] Clicking support button"),e.click()):console.error("[UnifiedWidget] Support button not found in DOM")},100)},M=()=>{const e=document.querySelector(".floating-test-call-modal"),n=document.querySelector(".help-support-window-v2");if(e&&window.getComputedStyle(e).display!=="none"){const o=e.querySelector('button[aria-label="Close"], .close-btn, [class*="close"]');o&&o.click()}if(n&&window.getComputedStyle(n).display!=="none"){const o=n.querySelector('button[aria-label="Close"], .close-btn, [class*="close"]');if(o)o.click();else{const l=document.querySelector(".help-support-widget-btn");l&&l.click()}}a(!1),d(!1)};return!w||!h?null:t.jsxs("div",{className:"unified-floating-widget",children:[t.jsx("button",{ref:S,className:`unified-widget-action-btn unified-widget-test-btn ${i?"unified-widget-btn-visible":""}`,onClick:C,title:"Test Call",children:t.jsxs("div",{className:"floating-test-call-sound-wave",children:[t.jsx("div",{className:"floating-test-call-sound-bar"}),t.jsx("div",{className:"floating-test-call-sound-bar"}),t.jsx("div",{className:"floating-test-call-sound-bar"}),t.jsx("div",{className:"floating-test-call-sound-bar"}),t.jsx("div",{className:"floating-test-call-sound-bar"})]})}),t.jsx("button",{ref:k,className:`unified-widget-action-btn unified-widget-support-btn ${i?"unified-widget-btn-visible":""}`,onClick:j,title:"Help & Support",children:t.jsx("img",{src:"/images/Group.svg",alt:"Help & Support",style:{width:"24px",height:"24px"}})}),t.jsxs("button",{className:`unified-widget-main-btn ${f||c?"rotated":""}`,onClick:y,onMouseEnter:()=>g(!0),onMouseLeave:()=>g(!1),title:i||c?"Close Menu":"Open Menu",children:[t.jsx("svg",{className:"unified-widget-plus-icon",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:t.jsx("path",{d:"M12 5V19M5 12H19",stroke:"white",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"})}),(i||c)&&t.jsx("button",{className:"unified-widget-close-btn",onClick:M,title:"Close",children:t.jsx("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",children:t.jsx("path",{d:"M9 3L3 9M3 3L9 9",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]})]})};export{I as default};
