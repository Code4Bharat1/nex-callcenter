import{a as k,r as c,j as e}from"./index-B_YWOrie.js";/* empty css                 */const T=({shop:j})=>{const[v]=k(),n=j||v.get("shop"),[x,d]=c.useState(!1),[p,t]=c.useState(null),[i,o]=c.useState({maxRetries:0,retryIntervalMinutes:0,autoCancelOnMaxRetries:!1,maxOutcomeRetries:null,allowedTimeStart:"09:00",allowedTimeEnd:"20:00",timezone:"Asia/Kolkata"}),[m,f]=c.useState({autoCallEnabled:!1}),[r,u]=c.useState({inboundEnabled:!1,phoneNumber:"",defaultInboundScriptId:null,inboundLookback:24}),[g,b]=c.useState([]);c.useEffect(()=>{N()},[n]);const N=async()=>{if(n)try{const a=await(await fetch(`/api/user-retry-settings?shop=${encodeURIComponent(n)}`,{credentials:"include"})).json();if(a.success&&a.settings){const l=a.settings;o({maxRetries:l.maxRetries||0,retryIntervalMinutes:l.retryIntervalMinutes||0,autoCancelOnMaxRetries:l.autoCancelOnMaxRetries||!1,maxOutcomeRetries:l.maxOutcomeRetries||null,allowedTimeStart:l.allowedTimeStart||"09:00",allowedTimeEnd:l.allowedTimeEnd||"20:00",timezone:l.timezone||"Asia/Kolkata"}),f({autoCallEnabled:l.autoCallEnabled||!1}),u({inboundEnabled:l.inboundEnabled||!1,phoneNumber:l.phoneNumber||"",defaultInboundScriptId:l.defaultInboundScriptId||null,inboundLookback:l.inboundLookback!==void 0&&l.inboundLookback!==null?l.inboundLookback:24})}const h=await(await fetch(`/api/scripts?shop=${encodeURIComponent(n)}`,{credentials:"include"})).json();h.success&&h.data&&b(h.data.scripts||[])}catch(s){console.error("Error loading settings:",s),t({type:"error",text:"Failed to load settings"})}},y=async()=>{if(n){d(!0),t(null);try{const a=await(await fetch("/api/retry-settings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shop:n,...i}),credentials:"include"})).json();a.success?t({type:"success",text:"Retry settings saved successfully"}):t({type:"error",text:a.error||"Failed to save retry settings"})}catch(s){t({type:"error",text:s.message||"Failed to save retry settings"})}finally{d(!1)}}},S=async()=>{if(n){d(!0),t(null);try{const a=await(await fetch("/api/auto-call-settings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shop:n,...m}),credentials:"include"})).json();a.success?t({type:"success",text:"Auto call settings saved successfully"}):t({type:"error",text:a.error||"Failed to save auto call settings"})}catch(s){t({type:"error",text:s.message||"Failed to save auto call settings"})}finally{d(!1)}}},C=async()=>{if(n){d(!0),t(null);try{const a=await(await fetch("/api/inbound-settings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shop:n,...r}),credentials:"include"})).json();a.success?t({type:"success",text:"Inbound settings saved successfully"}):t({type:"error",text:a.error||"Failed to save inbound settings"})}catch(s){t({type:"error",text:s.message||"Failed to save inbound settings"})}finally{d(!1)}}},w=async()=>{await Promise.all([y(),S(),C()])};return n?e.jsxs("div",{className:"settings-container",children:[p&&e.jsx("div",{style:{padding:"12px 16px",marginBottom:"16px",borderRadius:"6px",background:p.type==="success"?"#DCFCE7":"#FEE2E2",color:p.type==="success"?"#047857":"#DC2626",border:`1px solid ${p.type==="success"?"#86EFAC":"#FECACA"}`,fontSize:"14px"},children:p.text}),e.jsxs("div",{className:"settings-card",children:[e.jsx("h3",{className:"card-heading",children:"Retry Settings"}),e.jsxs("div",{className:"profile-detail-section",children:[e.jsx("h3",{className:"profile-detail-subheading",children:"Failed Call Retries"}),e.jsxs("div",{className:"profile-detail-box",children:[e.jsxs("div",{className:"profile-detail-item",children:[e.jsxs("div",{className:"profile-detail-label",children:[e.jsx("span",{children:"How Many Times to Retry"}),e.jsx("span",{className:"profile-detail-hint",children:"How many times should we try calling if first call fails? (0-10)"})]}),e.jsx("div",{className:"profile-detail-action",children:e.jsx("input",{type:"number",className:"profile-detail-input",min:"0",max:"10",value:i.maxRetries,onChange:s=>{const a=s.target.value===""?0:parseInt(s.target.value);isNaN(a)||o({...i,maxRetries:a})}})})]}),e.jsx("hr",{className:"profile-detail-divider"}),e.jsxs("div",{className:"profile-detail-item",children:[e.jsxs("div",{className:"profile-detail-label",children:[e.jsx("span",{children:"Wait Time Between Retries"}),e.jsx("span",{className:"profile-detail-hint",children:"How long to wait before trying again (in minutes)"})]}),e.jsx("div",{className:"profile-detail-action",children:e.jsx("input",{type:"number",className:"profile-detail-input",min:"2",max:"1440",value:i.retryIntervalMinutes,onChange:s=>o({...i,retryIntervalMinutes:parseInt(s.target.value)})})})]})]})]}),e.jsxs("div",{className:"profile-detail-section",children:[e.jsx("h3",{className:"profile-detail-subheading",children:"Auto-Cancel"}),e.jsx("div",{className:"profile-detail-box",children:e.jsxs("div",{className:"profile-detail-item",children:[e.jsxs("div",{className:"profile-detail-label",children:[e.jsx("span",{children:"Auto cancel in Shopify after max retries"}),e.jsx("span",{className:"profile-detail-hint",children:"Automatically cancel order in Shopify when we've tried calling the maximum number of times"})]}),e.jsx("div",{className:"profile-detail-action",children:e.jsxs("label",{className:"profile-toggle-switch",children:[e.jsx("input",{type:"checkbox",checked:i.autoCancelOnMaxRetries,onChange:s=>o({...i,autoCancelOnMaxRetries:s.target.checked})}),e.jsx("span",{className:"profile-toggle-slider"})]})})]})})]}),e.jsxs("div",{className:"profile-detail-section",children:[e.jsx("h3",{className:"profile-detail-subheading",children:"Retry Outcome"}),e.jsx("div",{className:"profile-detail-box",children:e.jsxs("div",{className:"profile-detail-item",children:[e.jsxs("div",{className:"profile-detail-label",children:[e.jsx("span",{children:"Max Outcome Retries"}),e.jsx("span",{className:"profile-detail-hint",children:"Maximum number of retries allowed for orders that match retry criteria (leave empty for no limit)"})]}),e.jsx("div",{className:"profile-detail-action",children:e.jsx("input",{type:"number",className:"profile-detail-input",min:"0",max:"100",value:i.maxOutcomeRetries!==null&&i.maxOutcomeRetries!==void 0?i.maxOutcomeRetries:"",placeholder:"No limit",onChange:s=>{const a=s.target.value===""?null:parseInt(s.target.value);(s.target.value===""||!isNaN(a)&&a>=0)&&o({...i,maxOutcomeRetries:a})}})})]})})]}),e.jsxs("div",{className:"profile-detail-section",children:[e.jsx("h3",{className:"profile-detail-subheading",children:"When to Make Calls"}),e.jsxs("div",{className:"profile-detail-box",children:[e.jsxs("div",{className:"profile-detail-item",children:[e.jsxs("div",{className:"profile-detail-label",children:[e.jsx("span",{children:"Start Time"}),e.jsx("span",{className:"profile-detail-hint",children:"Earliest time we can start calling"})]}),e.jsx("div",{className:"profile-detail-action",children:e.jsx("input",{type:"time",className:"profile-detail-input",value:i.allowedTimeStart,onChange:s=>o({...i,allowedTimeStart:s.target.value})})})]}),e.jsx("hr",{className:"profile-detail-divider"}),e.jsxs("div",{className:"profile-detail-item",children:[e.jsxs("div",{className:"profile-detail-label",children:[e.jsx("span",{children:"End Time"}),e.jsx("span",{className:"profile-detail-hint",children:"Latest time we can make calls"})]}),e.jsx("div",{className:"profile-detail-action",children:e.jsx("input",{type:"time",className:"profile-detail-input",value:i.allowedTimeEnd,onChange:s=>o({...i,allowedTimeEnd:s.target.value})})})]}),e.jsx("hr",{className:"profile-detail-divider"}),e.jsxs("div",{className:"profile-detail-item",children:[e.jsxs("div",{className:"profile-detail-label",children:[e.jsx("span",{children:"Timezone"}),e.jsx("span",{className:"profile-detail-hint",children:"Your local timezone"})]}),e.jsx("div",{className:"profile-detail-action",children:e.jsxs("select",{className:"profile-detail-input",value:i.timezone,onChange:s=>o({...i,timezone:s.target.value}),children:[e.jsx("option",{value:"Asia/Kolkata",children:"Asia/Kolkata (IST)"}),e.jsx("option",{value:"Asia/Dubai",children:"Asia/Dubai (GST)"}),e.jsx("option",{value:"America/New_York",children:"America/New_York (EST)"}),e.jsx("option",{value:"America/Los_Angeles",children:"America/Los_Angeles (PST)"}),e.jsx("option",{value:"Europe/London",children:"Europe/London (GMT)"}),e.jsx("option",{value:"Europe/Paris",children:"Europe/Paris (CET)"})]})})]})]})]}),e.jsxs("div",{className:"profile-detail-section",children:[e.jsx("h3",{className:"profile-detail-subheading",children:"Automation"}),e.jsx("div",{className:"profile-detail-box",children:e.jsxs("div",{className:"profile-detail-item",children:[e.jsxs("div",{className:"profile-detail-label",children:[e.jsx("span",{children:"Automatically call new orders"}),e.jsx("span",{className:"profile-detail-hint",children:"Start calling new orders automatically as soon as they come in"})]}),e.jsx("div",{className:"profile-detail-action",children:e.jsxs("label",{className:"profile-toggle-switch",children:[e.jsx("input",{type:"checkbox",checked:m.autoCallEnabled,onChange:s=>{const a=s.target.checked;f({...m,autoCallEnabled:a})}}),e.jsx("span",{className:"profile-toggle-slider"})]})})]})})]})]}),e.jsx("div",{className:"profile-save-container",children:e.jsx("button",{className:"profile-save-button-new",onClick:w,disabled:x,children:x?"Saving...":"Save All Settings"})}),e.jsxs("div",{className:"settings-card",children:[e.jsx("h3",{className:"card-heading",children:"Inbound Call Settings"}),e.jsxs("div",{className:"profile-detail-section",children:[e.jsx("h3",{className:"profile-detail-subheading",children:"Inbound Call Routing"}),e.jsxs("div",{className:"profile-detail-box",children:[e.jsxs("div",{className:"profile-detail-item",children:[e.jsx("div",{className:"profile-detail-label",children:e.jsx("span",{children:"Enable Inbound Calls"})}),e.jsx("div",{className:"profile-detail-action",children:e.jsxs("label",{className:"profile-toggle-switch",children:[e.jsx("input",{type:"checkbox",checked:r.inboundEnabled,onChange:s=>u({...r,inboundEnabled:s.target.checked})}),e.jsx("span",{className:"profile-toggle-slider"})]})})]}),e.jsx("hr",{className:"profile-detail-divider"}),e.jsxs("div",{className:"profile-detail-item",children:[e.jsxs("div",{className:"profile-detail-label",children:[e.jsx("span",{children:"Inbound Phone Number"}),e.jsx("span",{className:"profile-detail-hint",children:"This number will be used for inbound calls"})]}),e.jsx("div",{className:"profile-detail-action",children:e.jsx("input",{type:"text",className:"profile-detail-input",value:r.phoneNumber,onChange:s=>u({...r,phoneNumber:s.target.value}),placeholder:"Enter inbound phone number"})})]}),e.jsx("hr",{className:"profile-detail-divider"}),e.jsxs("div",{className:"profile-detail-item",children:[e.jsxs("div",{className:"profile-detail-label",children:[e.jsx("span",{children:"Inbound Lookback Period"}),e.jsx("span",{className:"profile-detail-hint",children:"How many hours to look back for inbound calls"})]}),e.jsx("div",{className:"profile-detail-action",children:e.jsx("input",{type:"number",className:"profile-detail-input",min:"1",max:"168",value:r.inboundLookback||"",onChange:s=>u({...r,inboundLookback:parseInt(s.target.value)||1}),placeholder:"24"})})]}),e.jsx("hr",{className:"profile-detail-divider"}),e.jsxs("div",{className:"profile-detail-item",children:[e.jsxs("div",{className:"profile-detail-label",children:[e.jsx("span",{children:"Default Inbound Script"}),e.jsx("span",{className:"profile-detail-hint",children:"Script to use for inbound calls"})]}),e.jsx("div",{className:"profile-detail-action",children:e.jsxs("select",{className:"profile-detail-input",value:r.defaultInboundScriptId||"",onChange:s=>u({...r,defaultInboundScriptId:s.target.value?parseInt(s.target.value):null}),children:[e.jsx("option",{value:"",children:"Select default script..."}),g.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})})]})]})]})]})]}):e.jsx("div",{className:"settings-container",children:e.jsx("div",{style:{textAlign:"center",padding:"100px 20px"},children:e.jsx("p",{style:{color:"#6B7280",fontSize:"16px"},children:"No shop selected. Please select a shop to view settings."})})})};export{T as default};
